_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[23],{kHJC:function(e,t,n){},lIq4:function(e,t,n){e.exports={container:"chat_container__3ZHmO",chatAndRandomOnlineUserContaner:"chat_chatAndRandomOnlineUserContaner__bY7tB",UserContaner:"chat_UserContaner__31eCg",listContacs:"chat_listContacs__16iTn",bottom:"chat_bottom__3CU3k",searchContainer:"chat_searchContainer__2w1wg",inputcss:"chat_inputcss__3AjM4",header:"chat_header__1EszN",chat:"chat_chat__N51MX",chatContainer:"chat_chatContainer__3BkyH",headerOfChatuserNameAndName:"chat_headerOfChatuserNameAndName__2LqfD",userImageContainer:"chat_userImageContainer__2ymDj",userName:"chat_userName__37SK5",messages:"chat_messages__2kX26",oneMessage:"chat_oneMessage__1A4yV",messageText:"chat_messageText__3cXj_",sendMessage:"chat_sendMessage__2c-k6",inputContainer:"chat_inputContainer__uedp2",btns:"chat_btns__2y6XH",sendMessageBtn:"chat_sendMessageBtn__21vJx",openOrCloseEmojiPicker:"chat_openOrCloseEmojiPicker__1m39t",emojiPickerContainer:"chat_emojiPickerContainer__gmNZL",emojiLogo:"chat_emojiLogo__4KSTL",btnsend:"chat_btnsend__a1iAT",userContainer:"chat_userContainer__13jMh",imgContainer:"chat_imgContainer__IpHHZ",FollowAndUnfollowContainer:"chat_FollowAndUnfollowContainer__3Ew5y",notSeenMessageNumbe:"chat_notSeenMessageNumbe__2SBtr"}},obeH:function(e,t,n){"use strict";n.r(t),n.d(t,"__N_SSP",(function(){return v}));var a=n("nKUr"),s=n("o0o1"),c=n.n(s),r=n("HaE+"),i=n("KQm4"),o=n("rePB"),u=n("ODXe"),d=n("q1tI"),l=n.n(d),j=n("lIq4"),h=n.n(j),b=n("PrJm"),m=n("RhP/"),_=(n("kHJC"),n("LzO8")),O=n("qJ0o"),f=n("W+wH"),g=n("Q25a");function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function x(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){Object(o.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var v=!0;t.default=function(e){var t=l.a.useState(!1),n=Object(u.a)(t,2),s=n[0],o=n[1],d=l.a.useState(9),j=Object(u.a)(d,2),p=j[0],v=(j[1],l.a.useState([])),w=Object(u.a)(v,2),S=w[0],M=w[1],k=l.a.useState({currentImageUrl:void 0,userName:void 0,_id:void 0}),y=Object(u.a)(k,2),P=y[0],U=y[1],E=l.a.useState(""),H=Object(u.a)(E,2),T=H[0],A=H[1],D=l.a.useState([]),I=Object(u.a)(D,2),L=I[0],B=I[1],q=l.a.useRef(null),J=l.a.useContext(g.a),X=Object(u.a)(J,2),Z=X[0],F=(X[1],l.a.useContext(f.a)),R=Object(u.a)(F,2),K=R[0],Q=(R[1],l.a.useState((function(){return 0}))),z=Object(u.a)(Q,2),V=z[0],W=z[1];l.a.useEffect((function(){void 0!=Z._id&&Z._id.length>2&&Object(O.d)({},e.token).then((function(e){var t=e.data.data.map((function(e){return e.firstUser._id==Z._id?Promise.resolve(x(x({},e.secoundUser),{},{notSeenMessageNumber:e.notSeenMessageNumber})):Promise.resolve(x(x({},e.firstUser),{},{notSeenMessageNumber:e.notSeenMessageNumber}))}));Promise.all(t).then((function(e){M(Object(i.a)(e))}))})).catch((function(e){return console.log(e.message)}))}),[Z]),l.a.useEffect((function(){void 0!=P._id&&Object(O.b)({secondUser:P._id,skip:0},e.token).then((function(e){B(Object(i.a)(e.data.data.reverse())),q.current.scrollTop=q.current.scrollHeight+q.current.clientHeight})).catch((function(e){console.log(e)}))}),[P]);var Y=function(e){U(e)};l.a.useEffect((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return new Audio("./msgSound.mp3").play(),e.next=4,S.map((function(e){return t.senderId==e._id&&P._id!=e._id?(e.notSeenMessageNumber=e.notSeenMessageNumber+1,Promise.resolve(e)):Promise.resolve(e)}));case 4:n=e.sent,Promise.all(n).then((function(e){M(e)})),t.senderId==P._id&&(A(""),B((function(e){var n=Math.random().toString(36).substring(7);return[].concat(Object(i.a)(e),[{users:[t.senderId],message:t.text,_id:n}])})),q.current.scrollTop=q.current.scrollHeight+q.current.clientHeight);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return void 0!=K&&null!=K&&K.on("getMessageFromUserToUser",e),function(){void 0!=K&&null!=K&&K.off("getMessageFromUserToUser",e)}}));return l.a.useEffect((function(){Object(O.b)({secondUser:P._id,skip:V},e.token).then((function(e){B((function(t){return[].concat(Object(i.a)(e.data.data.reverse()),Object(i.a)(t))}))})).catch((function(e){console.log(e)}))}),[V]),Object(a.jsxs)("div",{className:h.a.container,children:[Object(a.jsx)(b.a,{token:e.token}),Object(a.jsxs)("div",{className:h.a.chatAndRandomOnlineUserContaner,children:[Object(a.jsxs)("div",{className:h.a.UserContaner,children:[Object(a.jsx)("div",{className:h.a.header,children:Object(a.jsx)("h1",{children:"contacts"})}),Object(a.jsx)("div",{className:h.a.listContacs,children:S.map((function(e){return Object(a.jsx)(C,{getUserdata:Y,userData:e},e._id)}))}),Object(a.jsx)("div",{className:h.a.bottom,children:Object(a.jsx)("div",{className:h.a.searchContainer,children:Object(a.jsxs)("div",{className:h.a.inputcss,children:[Object(a.jsx)("input",{onChange:function(t){return function(t){Object(_.p)(t.target.value,e.token).then((function(e){void 0!=e.data.data&&M((function(t){return Object(i.a)(e.data.data)}))}))}(t)},type:"text",required:!0}),Object(a.jsx)("label",{children:Object(a.jsx)("span",{children:"Search users"})})]})})})]}),Object(a.jsxs)("div",{className:h.a.chat,children:[Object(a.jsx)("div",{className:h.a.header,children:Object(a.jsx)("h1",{children:"Messages"})}),Object(a.jsxs)("div",{className:h.a.chatContainer,children:[Object(a.jsxs)("div",{className:h.a.headerOfChatuserNameAndName,children:[Object(a.jsx)("div",{className:h.a.userImageContainer,children:Object(a.jsx)("img",{src:P.currentImageUrl||"/avatar.png"})}),Object(a.jsx)("div",{className:h.a.userName,children:Object(a.jsx)("h3",{children:P.userName})})]}),Object(a.jsx)("div",{onScroll:function(e){return function(e){0===e.target.scrollTop&&W((function(e){return e+20}))}(e)},ref:q,className:h.a.messages,children:L.map((function(e){return Object(a.jsx)("div",{className:h.a.oneMessage,children:e.users[0]==P._id?Object(a.jsx)("div",{className:h.a.messageText,"text-data":void 0!=e.date&&e.date.slice(0,10)+" "+e.date.slice(11,16),style:{"--i":"0%",float:"left",backgroundColor:"#e4e6eb",color:"black"},children:Object(a.jsx)("p",{children:e.message})}):Object(a.jsx)("div",{className:h.a.messageText,"text-data":void 0!=e.date&&e.date.slice(0,10)+" "+e.date.slice(11,16),style:{"--i":"-100%",float:"right",backgroundColor:"#1876f3",color:"white"},children:Object(a.jsx)("p",{children:e.message})})},e._id)}))})]}),Object(a.jsx)("div",{className:h.a.sendMessage,children:Object(a.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(a.jsx)("div",{className:h.a.inputContainer,children:Object(a.jsxs)("div",{className:h.a.inputcss,children:[Object(a.jsx)("input",{value:T,onChange:function(e){return function(e){A(e.target.value)}(e)},type:"text",required:!0}),Object(a.jsx)("label",{children:Object(a.jsx)("span",{children:"Message"})})]})}),Object(a.jsxs)("div",{className:h.a.btns,children:[Object(a.jsxs)("div",{className:h.a.openOrCloseEmojiPicker,onClick:function(){o((function(e){return!e}))},children:[Object(a.jsx)("div",{className:h.a.emojiLogo,children:Object(a.jsx)(m.a,{emoji:{id:"smiling_face_with_3_hearts",skin:3},size:16})}),s&&Object(a.jsx)("div",{className:h.a.emojiPickerContainer,children:Object(a.jsx)(m.b,{perLine:p,onSelect:function(e){return function(e){var t=e.unified.split("-"),n=[];t.forEach((function(e){return n.push("0x"+e)}));var a=String.fromCodePoint.apply(String,n);A((function(e){return e+a}))}(e)}})})]}),Object(a.jsx)("button",{type:"submit",className:h.a.btnsend,onClick:function(){T.length>0&&void 0!=P._id&&Object(O.a)({receiver:P._id,message:T,FirstTime:L.length},e.token).then((function(e){B((function(e){var t=Math.random().toString(36).substring(7);return[].concat(Object(i.a)(e),[{users:[Z._id],message:T,_id:t}])})),q.current.scrollTop=q.current.scrollHeight+q.current.clientHeight,K.emit("sendMessageFromUserToUser",{otherUserId:P._id,text:T,senderId:Z._id}),A("")})).catch((function(e){console.log(e)}))},children:Object(a.jsx)("span",{className:h.a.sendMessageBtn,children:Object(a.jsx)(N,{})})})]})]})})]})]})]})};var N=function(){return Object(a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",children:Object(a.jsxs)("g",{id:"Layer_95","data-name":"Layer 95",children:[Object(a.jsx)("path",{d:"M53.06,10.94a1.5,1.5,0,0,0-1.53-.36l-40,13.33a1.51,1.51,0,0,0-.06,2.83l18.7,7.09,7.09,18.7a1.51,1.51,0,0,0,1.44,1,1.49,1.49,0,0,0,1.39-1l13.33-40A1.5,1.5,0,0,0,53.06,10.94Z"}),Object(a.jsx)("path",{d:"M20.22,35.48a1.5,1.5,0,0,0-2.12-2.12l-4.48,4.48a1.51,1.51,0,0,0,0,2.12,1.49,1.49,0,0,0,2.12,0Z"}),Object(a.jsx)("path",{d:"M23.88,40.12a1.49,1.49,0,0,0-2.12,0L16.08,45.8a1.5,1.5,0,0,0,2.12,2.12l5.68-5.68A1.49,1.49,0,0,0,23.88,40.12Z"}),Object(a.jsx)("path",{d:"M28.52,43.78,24,48.26a1.5,1.5,0,0,0,2.12,2.12l4.48-4.48A1.5,1.5,0,0,0,28.52,43.78Z"})]})})},C=function(e){var t=l.a.useState(e.userData.notSeenMessageNumber),n=Object(u.a)(t,2),s=n[0],c=n[1];return l.a.useEffect((function(){c(e.userData.notSeenMessageNumber)}),[e.userData.notSeenMessageNumber]),Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:h.a.userContainer,onClick:function(){e.getUserdata(e.userData),c(0)},children:[0!=s&&Object(a.jsx)("div",{className:h.a.notSeenMessageNumbe,children:Object(a.jsx)("span",{children:s})}),Object(a.jsx)("div",{className:h.a.imgContainer,children:Object(a.jsx)("img",{src:e.userData.currentImageUrl||"/avatar.png"})}),Object(a.jsx)("div",{className:h.a.userName,children:Object(a.jsx)("p",{children:e.userData.userName})})]})})}},wuLQ:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return n("obeH")}])}},[["wuLQ",0,2,11,8,6,7,14,1,3,5,4,9,10,12,13,15]]]);