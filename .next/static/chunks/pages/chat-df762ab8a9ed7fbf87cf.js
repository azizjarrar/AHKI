_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[23],{kHJC:function(e,t,n){},lIq4:function(e,t,n){e.exports={container:"chat_container__3ZHmO",chatAndRandomOnlineUserContaner:"chat_chatAndRandomOnlineUserContaner__bY7tB",UserContaner:"chat_UserContaner__31eCg",listContacs:"chat_listContacs__16iTn",bottom:"chat_bottom__3CU3k",searchContainer:"chat_searchContainer__2w1wg",inputcss:"chat_inputcss__3AjM4",header:"chat_header__1EszN",chat:"chat_chat__N51MX",chatContainer:"chat_chatContainer__3BkyH",headerOfChatuserNameAndName:"chat_headerOfChatuserNameAndName__2LqfD",userImageContainer:"chat_userImageContainer__2ymDj",userName:"chat_userName__37SK5",messages:"chat_messages__2kX26",oneMessage:"chat_oneMessage__1A4yV",messageText:"chat_messageText__3cXj_",sendMessage:"chat_sendMessage__2c-k6",inputContainer:"chat_inputContainer__uedp2",btns:"chat_btns__2y6XH",sendMessageBtn:"chat_sendMessageBtn__21vJx",openOrCloseEmojiPicker:"chat_openOrCloseEmojiPicker__1m39t",emojiPickerContainer:"chat_emojiPickerContainer__gmNZL",emojiLogo:"chat_emojiLogo__4KSTL",btnsend:"chat_btnsend__a1iAT",userContainer:"chat_userContainer__13jMh",imgContainer:"chat_imgContainer__IpHHZ",FollowAndUnfollowContainer:"chat_FollowAndUnfollowContainer__3Ew5y",notSeenMessageNumbe:"chat_notSeenMessageNumbe__2SBtr",isWritingContainer:"chat_isWritingContainer__e6yTb",ldsellipsis:"chat_ldsellipsis__113dY",ldsellipsis1:"chat_ldsellipsis1__1oeKY",ldsellipsis2:"chat_ldsellipsis2__wi3pK",ldsellipsis3:"chat_ldsellipsis3__KW1Sl",seen:"chat_seen__2sLob",Style:"chat_Style__q-4t3",yourMessageVu:"chat_yourMessageVu__TwFQ2",changeColorContainer:"chat_changeColorContainer__2OoQT",chatColor:"chat_chatColor__a5hxO",colorPicker:"chat_colorPicker__3s1ZE",color:"chat_color__3deXf"}},obeH:function(e,t,n){"use strict";n.r(t),n.d(t,"__N_SSP",(function(){return x}));var a=n("nKUr"),s=n("o0o1"),c=n.n(s),r=n("HaE+"),o=n("KQm4"),i=n("rePB"),l=n("ODXe"),d=n("q1tI"),u=n.n(d),j=n("lIq4"),h=n.n(j),b=n("PrJm"),f=n("RhP/"),_=(n("kHJC"),n("LzO8")),m=n("qJ0o"),g=n("W+wH"),O=n("Q25a");function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach((function(t){Object(i.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=!0;t.default=function(e){var t=u.a.useState(!1),n=Object(l.a)(t,2),s=n[0],i=n[1],d=u.a.useState(9),j=Object(l.a)(d,2),v=j[0],x=(j[1],u.a.useState([])),y=Object(l.a)(x,2),S=y[0],w=y[1],M=u.a.useState({currentImageUrl:void 0,userName:void 0,_id:void 0}),U=Object(l.a)(M,2),P=U[0],E=U[1],T=u.a.useState(""),I=Object(l.a)(T,2),H=I[0],D=I[1],A=u.a.useState([]),L=Object(l.a)(A,2),W=L[0],B=L[1],q=u.a.useRef(null),V=u.a.useContext(O.a),X=Object(l.a)(V,2),Z=X[0],F=(X[1],u.a.useContext(g.a)),J=Object(l.a)(F,2),K=J[0],Q=(J[1],u.a.useState((function(){return 0}))),R=Object(l.a)(Q,2),z=R[0],Y=R[1],G=u.a.useState(!1),$=Object(l.a)(G,2),ee=$[0],te=$[1],ne=u.a.useState({colorone:"#1876f3",colortwo:"#e4e6eb"}),ae=Object(l.a)(ne,2),se=ae[0],ce=ae[1];u.a.useEffect((function(){void 0!=Z._id&&Z._id.length>2&&Object(m.d)({},e.token).then((function(e){var t=e.data.data.map((function(e){return e.firstUser._id==Z._id?Promise.resolve(C(C({},e.secoundUser),{},{color:e.color,notSeenMessageNumber:e.notSeenMessageNumber})):Promise.resolve(C(C({},e.firstUser),{},{color:e.color,notSeenMessageNumber:e.notSeenMessageNumber}))}));Promise.all(t).then((function(e){w(Object(o.a)(e))}))})).catch((function(e){return console.log(e.message)}))}),[Z]),u.a.useEffect((function(){void 0!=P._id&&(Object(m.b)({secondUser:P._id,skip:0},e.token).then((function(e){B(Object(o.a)(e.data.data.reverse())),q.current.scrollTop=q.current.scrollHeight+q.current.clientHeight})).catch((function(e){console.log(e)})),K.emit("vu",{state:!0,otherUserId:P._id}))}),[P]);var re=function(e){E(e)};u.a.useEffect((function(){function e(e){return t.apply(this,arguments)}function t(){return(t=Object(r.a)(c.a.mark((function e(t){var n;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return new Audio("./msgSound.mp3").play(),te(!1),K.emit("vu",{state:!0,otherUserId:P._id}),e.next=6,S.map((function(e){return t.senderId==e._id&&P._id!=e._id?(e.notSeenMessageNumber=e.notSeenMessageNumber+1,Promise.resolve(e)):Promise.resolve(e)}));case 6:n=e.sent,Promise.all(n).then((function(e){w(e)})),t.senderId==P._id&&(B((function(e){var n=Math.random().toString(36).substring(7);return[].concat(Object(o.a)(e),[{users:[t.senderId],message:t.text,_id:n}])})),q.current.scrollTop=q.current.scrollHeight+q.current.clientHeight);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function n(e){e.userWhoReciveWriting==Z._id&&e.senderid==P._id&&te(e.isWriting)}var a=function(e){if(0!=document.getElementsByClassName(h.a.yourMessageVu).length)for(var t=W.length-1;t>0;t--)void 0!=document.getElementsByClassName(h.a.yourMessageVu)[t]&&"rgb(24, 118, 243)"!=document.getElementsByClassName(h.a.yourMessageVu)[t].childNodes[1].style.color&&(document.getElementsByClassName(h.a.yourMessageVu)[t].childNodes[1].style.color="rgb(24, 118, 243)")};return void 0!=K&&null!=K&&(K.on("isWritingState",n),K.on("getMessageFromUserToUser",e),K.on("setvu",a)),function(){void 0!=K&&null!=K&&(K.off("getMessageFromUserToUser",e),K.off("isWritingState",n),K.off("setvu",a))}}));u.a.useEffect((function(){Object(m.b)({secondUser:P._id,skip:z},e.token).then((function(e){B((function(t){return[].concat(Object(o.a)(e.data.data.reverse()),Object(o.a)(t))}))})).catch((function(e){console.log(e)}))}),[z]);var oe=function(e){ce((function(t){return C(C({},t),{},{colorone:e})}))};return Object(a.jsxs)("div",{className:h.a.container,children:[Object(a.jsx)(b.a,{token:e.token}),Object(a.jsxs)("div",{className:h.a.chatAndRandomOnlineUserContaner,children:[Object(a.jsxs)("div",{className:h.a.UserContaner,children:[Object(a.jsx)("div",{className:h.a.header,children:Object(a.jsx)("h1",{children:"contacts"})}),Object(a.jsx)("div",{className:h.a.listContacs,children:S.map((function(e){return Object(a.jsx)(p,{setColorOfChat:oe,getUserdata:re,userData:e},e._id)}))}),Object(a.jsx)("div",{className:h.a.bottom,children:Object(a.jsx)("div",{className:h.a.searchContainer,children:Object(a.jsxs)("div",{className:h.a.inputcss,children:[Object(a.jsx)("input",{onChange:function(t){return function(t){Object(_.p)(t.target.value,e.token).then((function(e){void 0!=e.data.data&&w((function(t){return Object(o.a)(e.data.data)}))}))}(t)},type:"text",required:!0}),Object(a.jsx)("label",{children:Object(a.jsx)("span",{children:"Search users"})})]})})})]}),Object(a.jsxs)("div",{className:h.a.chat,children:[Object(a.jsx)("div",{className:h.a.header,children:Object(a.jsx)("h1",{children:"Messages"})}),Object(a.jsxs)("div",{className:h.a.chatContainer,children:[Object(a.jsxs)("div",{className:h.a.headerOfChatuserNameAndName,children:[Object(a.jsx)("div",{className:h.a.userImageContainer,children:Object(a.jsx)("img",{src:P.currentImageUrl||"/avatar.png"})}),Object(a.jsx)("div",{className:h.a.userName,children:Object(a.jsx)("h3",{children:P.userName})}),ee&&Object(a.jsx)("div",{className:h.a.isWritingContainer,children:Object(a.jsxs)("div",{className:h.a.ldsellipsis,children:[Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{}),Object(a.jsx)("div",{})]})}),Object(a.jsx)("div",{className:h.a.changeColorContainer,children:Object(a.jsx)(k,{receiver:P._id,token:e.token,getNewColorfn:function(e){ce((function(t){return C(C({},t),{},{colorone:e})}))},chatColor:se})})]}),Object(a.jsx)("div",{onScroll:function(e){return function(e){0===e.target.scrollTop&&Y((function(e){return e+20}))}(e)},ref:q,className:h.a.messages,children:W.map((function(e){return Object(a.jsx)("div",{className:h.a.oneMessage,children:e.users[0]==P._id?Object(a.jsx)("div",{className:h.a.messageText,"text-data":void 0!=e.date?e.date.slice(0,10)+" "+e.date.slice(11,16):"false",style:{"--i":"0%",float:"left",backgroundColor:"#e4e6eb",color:"black"},children:Object(a.jsx)("p",{children:e.message})}):Object(a.jsxs)("div",{className:"".concat(h.a.messageText," ").concat(h.a.yourMessageVu," "),"text-data":void 0!=e.date?e.date.slice(0,10)+" "+e.date.slice(11,16):"false",style:{"--i":"-100%",float:"right",backgroundColor:se.colorone,color:"white"},children:[Object(a.jsx)("p",{children:e.message}),Object(a.jsx)("span",{style:1==e.seen?{color:"#1876f3"}:{color:"black"},className:h.a.seen,children:"\u2714"})]})},e._id)}))})]}),Object(a.jsx)("div",{className:h.a.sendMessage,children:Object(a.jsxs)("form",{onSubmit:function(e){return e.preventDefault()},children:[Object(a.jsx)("div",{className:h.a.inputContainer,children:Object(a.jsxs)("div",{className:h.a.inputcss,children:[Object(a.jsx)("input",{value:H,onChange:function(e){return function(e){void 0!=P._id&&(e.target.value.length>0?K.emit("isWriting",{isWriting:!0,otherUserId:P._id,senderid:Z._id}):K.emit("isWriting",{isWriting:!1,otherUserId:P._id,senderid:Z._id})),D(e.target.value)}(e)},type:"text",required:!0}),Object(a.jsx)("label",{children:Object(a.jsx)("span",{children:"Message"})})]})}),Object(a.jsxs)("div",{className:h.a.btns,children:[Object(a.jsxs)("div",{className:h.a.openOrCloseEmojiPicker,onClick:function(){i((function(e){return!e}))},children:[Object(a.jsx)("div",{className:h.a.emojiLogo,children:Object(a.jsx)(f.a,{emoji:{id:"smiling_face_with_3_hearts",skin:3},size:16})}),s&&Object(a.jsx)("div",{className:h.a.emojiPickerContainer,children:Object(a.jsx)(f.b,{perLine:v,onSelect:function(e){return function(e){var t=e.unified.split("-"),n=[];t.forEach((function(e){return n.push("0x"+e)}));var a=String.fromCodePoint.apply(String,n);D((function(e){return e+a}))}(e)}})})]}),Object(a.jsx)("button",{type:"submit",className:h.a.btnsend,onClick:function(){H.length>0&&void 0!=P._id&&Object(m.a)({receiver:P._id,message:H,FirstTime:W.length},e.token).then((function(e){B((function(e){var t=Math.random().toString(36).substring(7);return[].concat(Object(o.a)(e),[{users:[Z._id],message:H,_id:t}])})),q.current.scrollTop=q.current.scrollHeight+q.current.clientHeight,K.emit("sendMessageFromUserToUser",{otherUserId:P._id,text:H,senderId:Z._id}),D("")})).catch((function(e){console.log(e)}))},children:Object(a.jsx)("span",{className:h.a.sendMessageBtn,children:Object(a.jsx)(N,{})})})]})]})})]})]})]})};var N=function(){return Object(a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 64 64",children:Object(a.jsxs)("g",{id:"Layer_95","data-name":"Layer 95",children:[Object(a.jsx)("path",{d:"M53.06,10.94a1.5,1.5,0,0,0-1.53-.36l-40,13.33a1.51,1.51,0,0,0-.06,2.83l18.7,7.09,7.09,18.7a1.51,1.51,0,0,0,1.44,1,1.49,1.49,0,0,0,1.39-1l13.33-40A1.5,1.5,0,0,0,53.06,10.94Z"}),Object(a.jsx)("path",{d:"M20.22,35.48a1.5,1.5,0,0,0-2.12-2.12l-4.48,4.48a1.51,1.51,0,0,0,0,2.12,1.49,1.49,0,0,0,2.12,0Z"}),Object(a.jsx)("path",{d:"M23.88,40.12a1.49,1.49,0,0,0-2.12,0L16.08,45.8a1.5,1.5,0,0,0,2.12,2.12l5.68-5.68A1.49,1.49,0,0,0,23.88,40.12Z"}),Object(a.jsx)("path",{d:"M28.52,43.78,24,48.26a1.5,1.5,0,0,0,2.12,2.12l4.48-4.48A1.5,1.5,0,0,0,28.52,43.78Z"})]})})},p=function(e){var t=u.a.useState(e.userData.notSeenMessageNumber),n=Object(l.a)(t,2),s=n[0],c=n[1];return u.a.useEffect((function(){c(e.userData.notSeenMessageNumber)}),[e.userData.notSeenMessageNumber]),Object(a.jsx)("div",{children:Object(a.jsxs)("div",{className:h.a.userContainer,onClick:function(){e.getUserdata(e.userData),c(0),e.setColorOfChat(e.userData.color)},children:[0!=s&&Object(a.jsx)("div",{className:h.a.notSeenMessageNumbe,children:Object(a.jsx)("span",{children:s})}),Object(a.jsx)("div",{className:h.a.imgContainer,children:Object(a.jsx)("img",{src:e.userData.currentImageUrl||"/avatar.png"})}),Object(a.jsx)("div",{className:h.a.userName,children:Object(a.jsx)("p",{children:e.userData.userName})})]})})},k=function(e){var t=u.a.useState(!1),n=Object(l.a)(t,2),s=n[0],c=n[1],r=function(t){e.getNewColorfn(t),Object(m.e)({newColor:t,receiver:e.receiver},e.token)};return Object(a.jsx)("div",{onClick:function(){return c((function(e){return!e}))},className:h.a.chatColor,style:{backgroundColor:e.chatColor.colorone},children:s&&Object(a.jsxs)("div",{className:h.a.colorPicker,children:[Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#ff1744")},style:{backgroundColor:"#ff1744"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#f50057")},style:{backgroundColor:"#f50057"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#3d5afe")},style:{backgroundColor:"#3d5afe"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#76ff03")},style:{backgroundColor:"#76ff03"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#c6ff00")},style:{backgroundColor:"#c6ff00"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#ff3d00")},style:{backgroundColor:"#ff3d00"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#651fff")},style:{backgroundColor:"#651fff"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#ffea00")},style:{backgroundColor:"#ffea00"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#f50057")},style:{backgroundColor:"#f50057"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#ff1744")},style:{backgroundColor:"#ff1744"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#1de9b6")},style:{backgroundColor:"#1de9b6"}}),Object(a.jsx)("div",{className:h.a.color,onClick:function(){return r("#03a9f4")},style:{backgroundColor:"#03a9f4"}})]})})}},wuLQ:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/chat",function(){return n("obeH")}])}},[["wuLQ",0,2,11,8,6,7,14,1,3,5,4,9,10,12,13,15]]]);