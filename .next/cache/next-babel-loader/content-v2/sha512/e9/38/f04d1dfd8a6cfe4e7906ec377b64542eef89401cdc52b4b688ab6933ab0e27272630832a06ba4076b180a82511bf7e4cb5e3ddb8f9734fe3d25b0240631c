{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport Style from '../../styles/forgetPassword.module.scss';\nimport Link from 'next/link';\nimport ModalSingInSingUp from '../../components/modalSingInSingUp/ModalSingInSingUp';\nimport { searchAccountToForgetPassword, resetPasswordApi, SetNewPasswordApi } from '../../services/user';\nimport PopUpMessage from '../../components/popUpMessage/popUpMessage';\nimport { useRouter } from 'next/router';\n\nconst forgetPassword = () => {\n  const [identity, setidentity] = React.useState(\"\"); //hedha i najem i koun ya email ya telephone il id li chi tala3 bih utilisateur chkon\n\n  const [userFound, setUserFound] = React.useState({\n    state: false,\n    userData: {}\n  }); //5arej error ken user mafamech\n\n  const [errorMessage, setErrorMessage] = React.useState({\n    state: false,\n    text: \"\"\n  }); // when state true show  pop up \n\n  const [modalSingInSingUp, setModalSingInSingUp] = React.useState(false); //open modal\n\n  const openModalSingInSingUp = () => {\n    setModalSingInSingUp(e => !e);\n  }; //tsaker ou thel modal mta3 login\n  //hedha li chi sagel fih il abed ki chi lawej ala rohou bil email wala tel\n\n\n  const changeHandler = e => {\n    setidentity({\n      identity: e.target.value\n    });\n  }; // hedhi tsaker il pop up ki tethal\n\n\n  const closePopUp = () => {\n    setErrorMessage({\n      state: false,\n      text: \"\"\n    });\n  }; //hedha il api li 5alik tlawej ala abed ken mawjoud wala le\n\n\n  const searchAccount = () => {\n    searchAccountToForgetPassword(identity).then(result => {\n      if (result.data.state == true) {\n        setUserFound({\n          state: true,\n          userData: result.data.data\n        });\n      } else {\n        setErrorMessage({\n          state: true,\n          text: \"user not found\"\n        });\n      }\n    });\n  };\n\n  const setErrorMessagefn = e => {\n    setErrorMessage(_objectSpread({}, e));\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: Style.container,\n    children: [modalSingInSingUp && /*#__PURE__*/_jsx(ModalSingInSingUp, {\n      openOrcloseModal: () => openModalSingInSingUp()\n    }), /*#__PURE__*/_jsxs(\"nav\", {\n      className: Style.nav,\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: Style.Logo,\n        children: /*#__PURE__*/_jsx(\"h1\", {\n          children: \"Spaksi\"\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Style.login,\n        children: /*#__PURE__*/_jsx(\"button\", {\n          onClick: () => openModalSingInSingUp(),\n          children: /*#__PURE__*/_jsx(\"p\", {\n            children: \"Log In\"\n          })\n        })\n      })]\n    }), errorMessage.state == true && /*#__PURE__*/_jsx(PopUpMessage, {\n      fnclose: closePopUp,\n      openPopUp: errorMessage\n    }), userFound.state && /*#__PURE__*/_jsx(UserFound, _objectSpread({\n      setErrorMessageProps: setErrorMessagefn\n    }, userFound.userData)), userFound.state == false && /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.forgetPassword,\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: Style.header,\n        children: /*#__PURE__*/_jsx(\"h1\", {\n          children: \"Find Your Account\"\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.warningTextAndInput,\n        children: [/*#__PURE__*/_jsx(\"p\", {\n          children: \"Please enter your email or phone number to search for your account.\"\n        }), /*#__PURE__*/_jsx(\"div\", {\n          onChange: e => changeHandler(e),\n          className: Style.inputContainer,\n          children: /*#__PURE__*/_jsx(\"input\", {\n            placeholder: \"email or Telephone\"\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.buttonsContainer,\n        children: [/*#__PURE__*/_jsx(\"button\", {\n          onClick: () => searchAccount(),\n          children: \"Search\"\n        }), /*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsx(\"button\", {\n            children: \"Cancel\"\n          })\n        })]\n      })]\n    })]\n  });\n};\n\nexport default forgetPassword;\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  return req.cookies.token ? {\n    props: {\n      token: req.cookies.token\n    },\n    redirect: {\n      destination: '/',\n      permanent: false\n    }\n  } : {\n    props: {}\n  };\n} // tawa ken il user mawjoud chtet7alek page o5ra feha il user ou kife i heb i raja3 compte mte3ou bil email wala bi tel\n\nconst UserFound = props => {\n  const [userDataReset, setUserDataReset] = React.useState(\"\"); //hne yet7at il haja li 5tarha email wala tel exmpale aziz@hotmail.com 52330766\n\n  const [type, setType] = React.useState(\"\"); //hne chit hot ken il abed 5tar email thout email ken 5tar tel thot tel bech il bd ya3rf ala chnouwa i lawej\n\n  const [resetCode, setResetCode] = React.useState(null); //hne ki tensel ala button badel pass chi jiblk il code li chit badel bih yetsagel hne\n\n  const RadioBoxHandler = e => {\n    setUserDataReset(e.target.value);\n  };\n\n  const resetPassword = () => {\n    if (userDataReset.indexOf(\"@\") != -1 && userDataReset.indexOf(\".\") != -1) {\n      resetPasswordApi({\n        type: \"email\",\n        email: userDataReset\n      }).then(result => {\n        setResetCode(result.data);\n        setType(\"email\");\n      }).catch(error => {\n        props.setErrorMessageProps({\n          state: true,\n          text: error.message\n        });\n      });\n    } else {//hne ki yebda tel\n    }\n  };\n\n  if (resetCode != null) {\n    return /*#__PURE__*/_jsx(SetNewPassword, {\n      setErrorMessageProps: props.setErrorMessageProps,\n      type: type,\n      userDataReset: userDataReset\n    });\n  } else {\n    return /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.userFoundContainer,\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: Style.userData,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Style.imageContainer,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            src: props.userProfileImageUrl || \"/avatar.png\"\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Style.userName,\n          children: /*#__PURE__*/_jsx(\"h3\", {\n            children: props.userName\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.radioBoxContainer,\n        children: [props.email != undefined && /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.radioInput,\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            children: [\"Email : \", props.email]\n          }), /*#__PURE__*/_jsx(\"input\", {\n            type: \"radio\",\n            onChange: e => RadioBoxHandler(e),\n            name: \"radio\",\n            value: props.email\n          })]\n        }), props.tel != undefined && /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.radioInput,\n          children: [/*#__PURE__*/_jsxs(\"p\", {\n            children: [\"Telephone : \", props.tel]\n          }), /*#__PURE__*/_jsx(\"input\", {\n            type: \"radio\",\n            onChange: e => RadioBoxHandler(e),\n            name: \"radio\",\n            value: props.tel\n          })]\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.buttonsContainer,\n        children: [/*#__PURE__*/_jsx(\"button\", {\n          onClick: () => resetPassword(),\n          children: \"Send\"\n        }), /*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsx(\"button\", {\n            children: \"Cancel\"\n          })\n        })]\n      })]\n    });\n  }\n};\n\nconst SetNewPassword = props => {\n  // hne ba3d masebon b3ath il code mte3ek chtethalk page thot feha code ou mdp mte3ek jdid\n  const [codeAndNewPassword, setCodeAndNewPassword] = React.useState(\"\"); //handler mta3 code ou pass jdid\n\n  const router = useRouter();\n\n  const changeToNewPassword = () => {\n    //type houwa email wala tel ou il userDateReset houwa exmpale azizjarrar@gmail.com ,52330766 \n    SetNewPasswordApi(_objectSpread(_objectSpread({}, codeAndNewPassword), {}, {\n      type: props.type,\n      identity: props.userDataReset\n    })).then(result => {\n      //            props.setErrorMessageProps({state:true,text:error.message})\n      if (result.data.typeError == \"done\") {\n        router.push(\"/\");\n      } else if (result.data.typeError == \"incorectCode\") {\n        props.setErrorMessageProps({\n          state: true,\n          text: \"code 8alet\"\n        });\n      } else {\n        props.setErrorMessageProps({\n          state: true,\n          text: \"code ofe wa9tou\"\n        });\n      }\n    });\n  };\n\n  const changeHandler = e => {\n    setCodeAndNewPassword(old => {\n      return _objectSpread(_objectSpread({}, old), {}, {\n        [e.target.name]: e.target.value\n      });\n    });\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: Style.SetNewPasswordContainer,\n    children: [/*#__PURE__*/_jsx(\"div\", {\n      className: Style.header,\n      children: /*#__PURE__*/_jsx(\"h1\", {\n        children: \"set new Password\"\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      onChange: e => changeHandler(e),\n      className: Style.inputContainer,\n      children: /*#__PURE__*/_jsx(\"input\", {\n        name: \"code\",\n        placeholder: \"code\"\n      })\n    }), /*#__PURE__*/_jsx(\"div\", {\n      onChange: e => changeHandler(e),\n      className: Style.inputContainer,\n      children: /*#__PURE__*/_jsx(\"input\", {\n        name: \"newPassword\",\n        type: \"password\",\n        placeholder: \"new Password\"\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.buttonsContainer,\n      children: [/*#__PURE__*/_jsx(\"button\", {\n        onClick: () => changeToNewPassword(),\n        children: \"Update\"\n      }), /*#__PURE__*/_jsx(Link, {\n        href: \"/\",\n        children: /*#__PURE__*/_jsx(\"button\", {\n          children: \"Cancel\"\n        })\n      })]\n    })]\n  });\n};","map":null,"metadata":{},"sourceType":"module"}