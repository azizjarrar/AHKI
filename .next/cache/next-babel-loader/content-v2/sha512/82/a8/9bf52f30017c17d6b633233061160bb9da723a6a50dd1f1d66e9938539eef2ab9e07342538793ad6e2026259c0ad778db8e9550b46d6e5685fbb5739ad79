{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport Style from '../../styles/profile.module.scss';\nimport Link from 'next/link';\nimport NavBar from '../../components/navBar/NavBar';\nimport UserContext from '../../context/userContext';\nimport LanguageContext from '../../context/languageContext';\nimport { ChangeProfileImage } from '../../services/user';\nimport PostUsersStorys from '../../components/postUsersStorys/postUsersStorys';\nimport Publication from '../../components/publication/publication';\nimport Suggestion from '../../components/suggestion/suggestion';\nimport Gellery from '../../components/gallery/gallery';\nimport Followersnavbar from '../../components/followers/followers';\nimport Followingnavbar from '../../components/following/following';\nimport { getCurrentUserPosts } from '../../services/post';\nimport BiggerImagewithcomments from '../../components/biggerImagewithcomments/biggerImagewithcomments';\nimport { countFollowingOfUser } from '../../services/following';\nimport { countFollowersOfUser } from '../../services/followers';\n\nconst Profile = props => {\n  const [yourFeeds, setYourFeeds] = React.useState(\"Your Posts\");\n  const [user, setUser] = React.useContext(UserContext);\n  const [language, setLanguage] = React.useContext(LanguageContext);\n  const [openFollowersState, setOpenFollowersState] = React.useState(false);\n  const [openFollowingState, setOpenFollowingState] = React.useState(false);\n  const [posts, setPosts] = React.useState([]);\n  const [MakeImageBigger, setMakeImageBigger] = React.useState(false);\n  const [doYouWanaAddTextToImage, setDoYouWanaAddTextToImage] = React.useState(false);\n  const [textAreaUpdateImage, setTextAreaUpdateImage] = React.useState(\"\");\n  const [image, setImage] = React.useState(undefined);\n  const [followingCount, setFollowingCount] = React.useState(0);\n  const [followersCount, setFollowersCount] = React.useState(0);\n  const [galleryState, setGalleryState] = React.useState(false);\n  /******************************************************************************************\r\n  this will change between your posts and your likes \r\n  ******************************************************************************************/\n\n  const change = e => {\n    setYourFeeds(e);\n  };\n\n  const changeFile = e => {\n    setImage(e.target.files[0]);\n    setDoYouWanaAddTextToImage(true);\n  };\n\n  const openFollowers = () => {\n    setOpenFollowersState(e => !e);\n  };\n\n  const openFollowing = () => {\n    setOpenFollowingState(e => !e);\n  };\n\n  const refrechDataFn = () => {\n    getCurrentUserPosts(user.token).then(result => {\n      setPosts([...result.data.data]);\n    }).catch(error => {\n      alert(error);\n    });\n  };\n\n  React.useEffect(() => {\n    if (user.token != undefined) {\n      getCurrentUserPosts(user.token).then(result => {\n        setPosts([...result.data.data]);\n      }).catch(error => {\n        alert(error);\n      });\n      countFollowingOfUser({\n        userid: user._id\n      }, props.token).then(result => {\n        setFollowingCount(result.data.count);\n      }).catch(error => {\n        alert(error);\n      });\n      countFollowersOfUser({\n        userid: user._id\n      }, props.token).then(result => {\n        setFollowersCount(result.data.count);\n      }).catch(error => {\n        alert(error);\n      });\n    }\n  }, [user]);\n\n  const textAreaHandlerUpdateImage = e => {\n    setTextAreaUpdateImage(e.target.value);\n  };\n\n  const MakeImageBiggerfn = () => {\n    setMakeImageBigger(e => !e);\n  };\n\n  const alertFn = alert => {\n    var formData = new FormData();\n\n    if (alert == \"yes\") {\n      formData.append('bio', textAreaUpdateImage);\n      formData.append('file', image);\n      ChangeProfileImage(formData, user.token).then(data => {\n        setUser(e => {\n          return _objectSpread(_objectSpread({}, e), {}, {\n            currentImageUrl: data.data.Picurl\n          });\n        });\n      });\n      setDoYouWanaAddTextToImage(false);\n    } else {\n      formData.append('file', image);\n      ChangeProfileImage(formData, user.token).then(data => {\n        setUser(e => {\n          return _objectSpread(_objectSpread({}, e), {}, {\n            currentImageUrl: data.data.Picurl\n          });\n        });\n      });\n      setDoYouWanaAddTextToImage(false);\n    }\n  };\n\n  const galleryStatefn = state => {\n    console.log(galleryState);\n    setGalleryState(state);\n  };\n\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: Style.container,\n    children: [/*#__PURE__*/_jsx(NavBar, {\n      token: props.token\n    }), openFollowersState && /*#__PURE__*/_jsx(Followersnavbar, {\n      token: props.token,\n      id: user._id,\n      closepopUp: openFollowers\n    }), openFollowingState && /*#__PURE__*/_jsx(Followingnavbar, {\n      token: props.token,\n      id: user._id,\n      closepopUp: openFollowing\n    }), MakeImageBigger && /*#__PURE__*/_jsx(BiggerImagewithcomments, {\n      userid: user._id,\n      token: props.token,\n      close: () => MakeImageBiggerfn(),\n      imgid: user.currentImgId\n    }), doYouWanaAddTextToImage && /*#__PURE__*/_jsx(\"div\", {\n      className: Style.alertYesNoContainer,\n      children: /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.alert,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Style.header,\n          children: /*#__PURE__*/_jsx(\"h2\", {\n            children: \"Leave something nice for the visitor\"\n          })\n        }), /*#__PURE__*/_jsx(\"textarea\", {\n          onChange: e => textAreaHandlerUpdateImage(e),\n          className: Style.contenteditable,\n          maxLength: \"200\"\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.btnContainer,\n          children: [/*#__PURE__*/_jsx(\"button\", {\n            className: Style.btnAlert,\n            onClick: () => alertFn(\"yes\"),\n            children: \"Yes\"\n          }), /*#__PURE__*/_jsx(\"button\", {\n            className: Style.btnAlert,\n            onClick: () => alertFn(\"no\"),\n            children: \"No\"\n          })]\n        })]\n      })\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.profile,\n      children: [/*#__PURE__*/_jsx(\"div\", {\n        className: Style.ProfileImage,\n        children: /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.image,\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: Style.underimage,\n            children: /*#__PURE__*/_jsx(\"img\", {\n              onClick: () => MakeImageBiggerfn(),\n              src: user.currentImageUrl || \"/avatar.png\",\n              alt: user.userName || \"\"\n            })\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.camera,\n            children: [/*#__PURE__*/_jsx(\"input\", {\n              onChange: e => changeFile(e),\n              type: \"file\"\n            }), /*#__PURE__*/_jsx(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              \"aria-hidden\": \"true\",\n              focusable: \"false\",\n              \"data-prefix\": \"fas\",\n              \"data-icon\": \"camera\",\n              role: \"img\",\n              viewBox: \"0 0 512 512\",\n              children: /*#__PURE__*/_jsx(\"path\", {\n                fill: \"currentColor\",\n                d: \"M512 144v288c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V144c0-26.5 21.5-48 48-48h88l12.3-32.9c7-18.7 24.9-31.1 44.9-31.1h125.5c20 0 37.9 12.4 44.9 31.1L376 96h88c26.5 0 48 21.5 48 48zM376 288c0-66.2-53.8-120-120-120s-120 53.8-120 120 53.8 120 120 120 120-53.8 120-120zm-32 0c0 48.5-39.5 88-88 88s-88-39.5-88-88 39.5-88 88-88 88 39.5 88 88z\"\n              })\n            })]\n          })]\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Style.userName,\n        children: /*#__PURE__*/_jsx(\"h2\", {\n          children: user.userName || user.firstName || \"No Name\"\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Style.bio,\n        children: /*#__PURE__*/_jsxs(\"h2\", {\n          children: [user.biography, \" \"]\n        })\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.profileStatus,\n        children: [/*#__PURE__*/_jsxs(\"h3\", {\n          onClick: () => openFollowing(),\n          children: [followingCount, \" \", language.Following]\n        }), \" \", /*#__PURE__*/_jsxs(\"h3\", {\n          onClick: () => openFollowers(),\n          children: [followersCount, \" \", language.Followers]\n        }), /*#__PURE__*/_jsx(Link, {\n          href: \"/settings\",\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.UpdateProfile,\n            children: [/*#__PURE__*/_jsx(\"h3\", {\n              children: language.UpdateProfile\n            }), /*#__PURE__*/_jsx(\"svg\", {\n              xmlns: \"http://www.w3.org/2000/svg\",\n              \"aria-hidden\": \"true\",\n              focusable: \"false\",\n              \"data-prefix\": \"fas\",\n              \"data-icon\": \"user-cog\",\n              role: \"img\",\n              viewBox: \"0 0 640 512\",\n              children: /*#__PURE__*/_jsx(\"path\", {\n                fill: \"#1876f3\",\n                d: \"M610.5 373.3c2.6-14.1 2.6-28.5 0-42.6l25.8-14.9c3-1.7 4.3-5.2 3.3-8.5-6.7-21.6-18.2-41.2-33.2-57.4-2.3-2.5-6-3.1-9-1.4l-25.8 14.9c-10.9-9.3-23.4-16.5-36.9-21.3v-29.8c0-3.4-2.4-6.4-5.7-7.1-22.3-5-45-4.8-66.2 0-3.3.7-5.7 3.7-5.7 7.1v29.8c-13.5 4.8-26 12-36.9 21.3l-25.8-14.9c-2.9-1.7-6.7-1.1-9 1.4-15 16.2-26.5 35.8-33.2 57.4-1 3.3.4 6.8 3.3 8.5l25.8 14.9c-2.6 14.1-2.6 28.5 0 42.6l-25.8 14.9c-3 1.7-4.3 5.2-3.3 8.5 6.7 21.6 18.2 41.1 33.2 57.4 2.3 2.5 6 3.1 9 1.4l25.8-14.9c10.9 9.3 23.4 16.5 36.9 21.3v29.8c0 3.4 2.4 6.4 5.7 7.1 22.3 5 45 4.8 66.2 0 3.3-.7 5.7-3.7 5.7-7.1v-29.8c13.5-4.8 26-12 36.9-21.3l25.8 14.9c2.9 1.7 6.7 1.1 9-1.4 15-16.2 26.5-35.8 33.2-57.4 1-3.3-.4-6.8-3.3-8.5l-25.8-14.9zM496 400.5c-26.8 0-48.5-21.8-48.5-48.5s21.8-48.5 48.5-48.5 48.5 21.8 48.5 48.5-21.7 48.5-48.5 48.5zM224 256c70.7 0 128-57.3 128-128S294.7 0 224 0 96 57.3 96 128s57.3 128 128 128zm201.2 226.5c-2.3-1.2-4.6-2.6-6.8-3.9l-7.9 4.6c-6 3.4-12.8 5.3-19.6 5.3-10.9 0-21.4-4.6-28.9-12.6-18.3-19.8-32.3-43.9-40.2-69.6-5.5-17.7 1.9-36.4 17.9-45.7l7.9-4.6c-.1-2.6-.1-5.2 0-7.8l-7.9-4.6c-16-9.2-23.4-28-17.9-45.7.9-2.9 2.2-5.8 3.2-8.7-3.8-.3-7.5-1.2-11.4-1.2h-16.7c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16h-16.7C60.2 288 0 348.2 0 422.4V464c0 26.5 21.5 48 48 48h352c10.1 0 19.5-3.2 27.2-8.5-1.2-3.8-2-7.7-2-11.8v-9.2z\"\n              })\n            })]\n          })\n        })]\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Style.timelineAndparameters,\n        children: /*#__PURE__*/_jsx(\"div\", {\n          className: Style.timeLineContainer,\n          children: /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.navbar,\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: Style.Line,\n              style: yourFeeds == \"Your Posts\" ? {\n                left: '0'\n              } : {\n                left: \"50%\"\n              }\n            }), /*#__PURE__*/_jsx(\"h2\", {\n              onClick: () => change(\"Your Posts\"),\n              children: language.YourPosts\n            }), /*#__PURE__*/_jsx(\"h2\", {\n              onClick: () => change(\"Likes\"),\n              children: language.Likes\n            })]\n          })\n        })\n      })]\n    }), /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.timeLine,\n      children: [/*#__PURE__*/_jsxs(\"div\", {\n        className: Style.params,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Style.GelleryContainer,\n          style: {\n            zIndex: galleryState ? \"9999999999\" : \"14\"\n          },\n          children: /*#__PURE__*/_jsx(Gellery, {\n            gellerystate: galleryStatefn,\n            userid: user._id,\n            token: props.token\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Style.suggestionContainer,\n          children: /*#__PURE__*/_jsx(Suggestion, {\n            token: props.token\n          })\n        })]\n      }), /*#__PURE__*/_jsxs(\"div\", {\n        className: Style.posts,\n        children: [/*#__PURE__*/_jsx(PostUsersStorys, {\n          refrechData: refrechDataFn\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Style.publicationContainer,\n          children: posts.map(e => {\n            return /*#__PURE__*/_jsx(Publication, {\n              allowAnonymeComments: e.allowAnonymeComments,\n              userName: user.userName,\n              ownerid: e.OwnerOfPost._id,\n              id: e._id,\n              date: e.date,\n              ownerOfPostImage: user.currentImageUrl,\n              text: e.postText,\n              video: e.postVideo != undefined ? e.postVideo : undefined,\n              image: e.postImage != undefined ? e.postImage : undefined\n            }, e._id);\n          })\n        })]\n      })]\n    })]\n  });\n};\n\nexport default Profile;\nexport async function getServerSideProps({\n  req,\n  res\n}) {\n  return req.cookies.token ? {\n    props: {\n      token: req.cookies.token\n    }\n  } : {\n    redirect: {\n      destination: '/',\n      permanent: false\n    }\n  };\n}","map":null,"metadata":{},"sourceType":"module"}