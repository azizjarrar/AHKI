{"ast":null,"code":"import _regeneratorRuntime from \"F:/AHKI/node_modules/next/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"F:/AHKI/node_modules/next/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _defineProperty from \"F:/AHKI/node_modules/next/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"F:/AHKI/node_modules/next/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"F:\\\\AHKI\\\\pages\\\\_app.js\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport '../styles/globals.scss';\nimport React from 'react';\nimport initLanguage from '../components/initLanguage/initLanguage';\nimport { GetUserData } from '../services/user';\nimport LinearProgress from '@material-ui/core/LinearProgress';\nimport UserContext from '../context/userContext';\nimport LanguageContext from '../context/languageContext';\nimport SocketContext from '../context/socketContext';\nimport ApiIsLoadingContext from '../context/apiIsLoadingContext';\nimport { useRouter } from 'next/router';\nimport io from 'socket.io-client';\nimport ip from '../const';\n\nfunction MyApp(_ref) {\n  _s();\n\n  var Component = _ref.Component,\n      pageProps = _ref.pageProps;\n\n  var _React$useState = React.useState({\n    image: \"\",\n    tel: \"\",\n    biography: \"\",\n    userName: \"\",\n    firstname: \"\",\n    lastname: \"\",\n    age: \"\",\n    following: 0,\n    followers: 0\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      user = _React$useState2[0],\n      setUser = _React$useState2[1];\n\n  var userProvider = React.useMemo(function () {\n    return {\n      user: user,\n      setUser: setUser\n    }, [user, setUser];\n  });\n  /********************************************************************/\n\n  var _React$useState3 = React.useState(_objectSpread({}, initLanguage(\"eng\"))),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      language = _React$useState4[0],\n      setLanguage = _React$useState4[1];\n\n  var languageProvider = React.useMemo(function () {\n    return {\n      language: language,\n      setLanguage: setLanguage\n    }, [language, setLanguage];\n  });\n  /********************************************************************/\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      isLoading = _React$useState6[0],\n      setIsLoading = _React$useState6[1];\n\n  var loadingProvider = React.useMemo(function () {\n    return {\n      isLoading: isLoading,\n      setIsLoading: setIsLoading\n    }, [isLoading, setIsLoading];\n  });\n  /********************************************************************/\n\n  var _React$useState7 = React.useState(undefined),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      socket = _React$useState8[0],\n      setSocket = _React$useState8[1];\n\n  var socketProvider = React.useMemo(function () {\n    return {\n      socket: socket,\n      setSocket: setSocket\n    }, [socket, setSocket];\n  });\n  /*****************************************************************/\n\n  var _React$useState9 = React.useState(false),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      onlyOnce = _React$useState10[0],\n      setonlyOnce = _React$useState10[1];\n\n  var router = useRouter();\n  var socketRef = React.useRef();\n  /*socket io*/\n\n  /************************************/\n\n  if (router.query.refrech == \"true\" && onlyOnce == false) {\n    setonlyOnce(true);\n    GetUserData(pageProps.token).then(function (data) {\n      setUser(function (e) {\n        return _objectSpread(_objectSpread(_objectSpread({}, e), data.data.data[0]), {}, {\n          token: pageProps.token\n        });\n      });\n    })[\"catch\"](function (e) {});\n  }\n\n  React.useEffect(function () {\n    /*****************init Token to userProvider******************/\n    setUser(function (e) {\n      return _objectSpread(_objectSpread({}, e), {}, {\n        token: pageProps.token\n      });\n    });\n    /*get current lang */\n\n    setLanguage(initLanguage(localStorage.getItem('language') || \"eng\"));\n    /***********************************************************/\n\n    /********************fetch user data online if there is token************************/\n\n    /***********************************************************/\n\n    if (pageProps.token) {\n      GetUserData(pageProps.token).then(function (data) {\n        try {\n          socketRef.current = io(ip, {\n            reconnection: false\n          });\n          socketRef.on('update', function (data) {\n            return console.log(data);\n          });\n          socketRef.on('connect_error', function (err) {\n            return handleErrors(err);\n          });\n          socketRef.on('connect_failed', function (err) {\n            return handleErrors(err);\n          });\n          socketRef.on('disconnect', function (err) {\n            return handleErrors(err);\n          });\n        } catch (error) {\n          console.log(error);\n        }\n\n        socketRef.current.on(\"getSocketid\", function (dataFromSocket) {\n          console.log(\"connect\");\n          socketRef.current.emit(\"saveuserOnline\", {\n            userid: data.data.data[0]._id,\n            socketid: dataFromSocket\n          });\n          setSocket(socketRef.current);\n        })[\"catch\"](function (error) {\n          console.log(error);\n        });\n        setUser(function (e) {\n          return _objectSpread(_objectSpread({}, e), data.data.data[0]);\n        });\n      })[\"catch\"](function (e) {});\n    }\n  }, [router.query.refrech]);\n  /******************************************************************************************\r\n   *******************************************************************************************\r\n   ******************************************************************************************/\n\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"appWrapper\",\n      children: /*#__PURE__*/_jsxDEV(LanguageContext.Provider, {\n        value: languageProvider,\n        children: /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n          value: userProvider,\n          children: /*#__PURE__*/_jsxDEV(ApiIsLoadingContext.Provider, {\n            value: loadingProvider,\n            children: /*#__PURE__*/_jsxDEV(SocketContext.Provider, {\n              value: socketProvider,\n              children: [isLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"loading\",\n                children: /*#__PURE__*/_jsxDEV(LinearProgress, {}, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 95,\n                  columnNumber: 52\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 95,\n                columnNumber: 27\n              }, this), /*#__PURE__*/_jsxDEV(Component, _objectSpread({}, pageProps), void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 96,\n                columnNumber: 15\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 94,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 90,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(MyApp, \"2ggWz+dS6ZeMF0pMmOUJAZWH5gY=\", false, function () {\n  return [useRouter];\n});\n\n_c = MyApp;\nexport default MyApp;\nexport function getInitialProps(_x) {\n  return _getInitialProps.apply(this, arguments);\n}\n\nfunction _getInitialProps() {\n  _getInitialProps = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(_ref2) {\n    var req, res;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            req = _ref2.req, res = _ref2.res;\n            _context.next = 3;\n            return req.cookies.token;\n\n          case 3:\n            if (!_context.sent) {\n              _context.next = 7;\n              break;\n            }\n\n            _context.t0 = {\n              props: {\n                token: true\n              }\n            };\n            _context.next = 8;\n            break;\n\n          case 7:\n            _context.t0 = {\n              redirect: {\n                destination: '/',\n                permanent: false\n              }\n            };\n\n          case 8:\n            return _context.abrupt(\"return\", _context.t0);\n\n          case 9:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n  return _getInitialProps.apply(this, arguments);\n}\n\nvar _c;\n\n$RefreshReg$(_c, \"MyApp\");","map":{"version":3,"sources":["F:/AHKI/pages/_app.js"],"names":["React","initLanguage","GetUserData","LinearProgress","UserContext","LanguageContext","SocketContext","ApiIsLoadingContext","useRouter","io","ip","MyApp","Component","pageProps","useState","image","tel","biography","userName","firstname","lastname","age","following","followers","user","setUser","userProvider","useMemo","language","setLanguage","languageProvider","isLoading","setIsLoading","loadingProvider","undefined","socket","setSocket","socketProvider","onlyOnce","setonlyOnce","router","socketRef","useRef","query","refrech","token","then","data","e","useEffect","localStorage","getItem","current","reconnection","on","console","log","err","handleErrors","error","dataFromSocket","emit","userid","_id","socketid","getInitialProps","req","res","cookies","props","redirect","destination","permanent"],"mappings":"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","sourcesContent":["import '../styles/globals.scss'\r\nimport React from 'react'\r\nimport initLanguage from '../components/initLanguage/initLanguage'\r\nimport { GetUserData } from '../services/user'\r\nimport LinearProgress from '@material-ui/core/LinearProgress';\r\nimport UserContext from '../context/userContext'\r\nimport LanguageContext from '../context/languageContext'\r\nimport SocketContext from '../context/socketContext'\r\nimport ApiIsLoadingContext from '../context/apiIsLoadingContext'\r\nimport { useRouter } from 'next/router'\r\nimport io from 'socket.io-client';\r\nimport ip from '../const'\r\n\r\n\r\nfunction MyApp({ Component, pageProps }) {\r\n  const [user, setUser] = React.useState({image:\"\",tel:\"\",biography:\"\",userName:\"\",firstname:\"\",lastname:\"\",age:\"\",following:0,followers:0})\r\n  const userProvider = React.useMemo(() => ({ user, setUser }, [user, setUser]))\r\n  /********************************************************************/\r\n  const [language, setLanguage] = React.useState({ ...initLanguage(\"eng\") })\r\n  const languageProvider = React.useMemo(() => ({ language, setLanguage }, [language, setLanguage]))\r\n  /********************************************************************/\r\n  const [isLoading, setIsLoading] = React.useState(false)\r\n  const loadingProvider = React.useMemo(() => ({ isLoading, setIsLoading }, [isLoading, setIsLoading]))\r\n  /********************************************************************/\r\n  const [socket, setSocket] = React.useState(undefined)\r\n  const socketProvider = React.useMemo(() => ({ socket, setSocket}, [socket, setSocket]))\r\n  /*****************************************************************/\r\n  const [onlyOnce,setonlyOnce]=React.useState(false)\r\n  const router = useRouter()\r\n  const socketRef = React.useRef()\r\n\r\n/*socket io*/\r\n\r\n  /************************************/ \r\n  if(router.query.refrech==\"true\" && onlyOnce==false){\r\n    setonlyOnce(true)\r\n    GetUserData(pageProps.token).then(data => { \r\n      \r\n      setUser(e => { return { ...e, ...data.data.data[0],token: pageProps.token } })\r\n\r\n     }).catch(e => { })\r\n\r\n  }\r\n\r\n  React.useEffect(() => {\r\n   \r\n\r\n    /*****************init Token to userProvider******************/\r\n    setUser(e => { return { ...e, token: pageProps.token } })\r\n    /*get current lang */\r\n    setLanguage(initLanguage(localStorage.getItem('language') || \"eng\"))\r\n\r\n\r\n    /***********************************************************/\r\n    /********************fetch user data online if there is token************************/\r\n    /***********************************************************/\r\n    \r\n    if (pageProps.token) {\r\n      GetUserData(pageProps.token).then(data => { \r\n        try{\r\n          socketRef.current =io(ip,{reconnection: false});\r\n          socketRef.on('update', data => console.log(data));\r\n\r\n          socketRef.on('connect_error', err => handleErrors(err));\r\n          socketRef.on('connect_failed', err => handleErrors(err));\r\n          socketRef.on('disconnect', err => handleErrors(err));\r\n        }catch(error){\r\n          console.log(error)\r\n        }\r\n        socketRef.current.on(\"getSocketid\",(dataFromSocket)=>{\r\n          console.log(\"connect\")\r\n        socketRef.current.emit(\"saveuserOnline\",{userid:data.data.data[0]._id,socketid:dataFromSocket})\r\n        setSocket(socketRef.current)\r\n        }).catch(error=>{\r\n          console.log(error)\r\n        })\r\n        setUser(e => { \r\n        return { ...e, ...data.data.data[0] } \r\n      }) \r\n      }).catch(e => { })\r\n    }\r\n  }, [router.query.refrech])\r\n\r\n  \r\n  /******************************************************************************************\r\n   *******************************************************************************************\r\n   ******************************************************************************************/\r\n  return (\r\n    <>\r\n      <div className='appWrapper'>\r\n        <LanguageContext.Provider value={languageProvider}>\r\n          <UserContext.Provider value={userProvider} >\r\n            <ApiIsLoadingContext.Provider value={loadingProvider}>\r\n              <SocketContext.Provider value={socketProvider}>\r\n              {isLoading&&<div className=\"loading\"><LinearProgress /></div>}\r\n              <Component {...pageProps} />\r\n              </SocketContext.Provider>\r\n            </ApiIsLoadingContext.Provider>\r\n          </UserContext.Provider>\r\n        </LanguageContext.Provider>\r\n      </div>\r\n    </>\r\n  )\r\n}\r\n\r\nexport default MyApp\r\nexport async function getInitialProps({ req, res }) {\r\n  return await req.cookies.token ? { props: { token: true } } : { redirect: { destination: '/', permanent: false, } }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}