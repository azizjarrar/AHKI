{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useState } from 'react';\nimport Style from './NavBar.module.scss';\nimport ModalSingInSingUp from '../modalSingInSingUp/ModalSingInSingUp';\nimport PorfileMenu from '../profileMenu/profileMenu';\nimport Link from 'next/link';\nimport UserContext from '../../context/userContext';\nimport SearchUser from '../../components/searchUser/searchUser';\nimport { useRouter } from 'next/router';\nimport Notification from '../../components/notification/notification';\nimport { getUnreadUsersChatsNumber } from '../../services/chat';\nimport socketContext from '../../context/socketContext';\nimport { GetOtherUsersData } from '../../services/user';\nimport { removeToken } from '../../services/user';\n\nconst NavBar = ({\n  token\n}) => {\n  const {\n    0: modalSingInSingUp,\n    1: setModalSingInSingUp\n  } = useState(false); //open modal\n\n  const [heightAndWidthOfWindow, setHeightAndWidthOfWindow] = React.useState({\n    width: 0,\n    height: 0\n  }); //responsive handler\n\n  const {\n    0: openMenuProfileState,\n    1: setOpenMenuProfile\n  } = useState(false); //on hover profile pic open menu\n\n  const [disyplaySearch, setDisplaySearch] = React.useState({\n    state: false,\n    userName: \"\"\n  });\n  const [user, setUser] = React.useContext(UserContext);\n  const [numberOfChatsNotRead, setNumberOfChatsNotRead] = React.useState(0);\n  const [socket, setSocket] = React.useContext(socketContext);\n  const [popUpUser, setPopUpUser] = React.useState(null);\n  const [popUpNotif, setpopUpNotif] = React.useState(() => 0);\n  const sideNavBarBtn = React.useRef(null);\n  const [showSideNavBar, setShowSideNavBar] = React.useState(false);\n  const router = useRouter();\n  React.useEffect(() => {\n    async function chatHandler(data) {\n      let audio = new Audio(\"./msgSound.mp3\");\n      audio.play();\n\n      if (router.pathname != \"/chat\") {\n        GetOtherUsersData(data.senderId, token).then(result => {\n          setPopUpUser(_objectSpread({}, result.data.data[0]));\n        }).catch(error => {\n          alert(error);\n        });\n      }\n    }\n\n    async function notifHandler(data) {\n      if (data.notif == 1) {\n        setpopUpNotif(e => e + 1);\n      }\n    }\n\n    if (socket != undefined && socket != null) {\n      socket.on(\"getMessageFromUserToUser\", chatHandler);\n      socket.on(\"getNotificationFromUserToUser\", notifHandler);\n    }\n\n    return () => {\n      if (socket != undefined && socket != null) {\n        socket.off('getMessageFromUserToUser', chatHandler);\n        socket.off('getNotificationFromUserToUser', notifHandler);\n      }\n    };\n  });\n  React.useEffect(() => {\n    setHeightAndWidthOfWindow({\n      height: window.innerHeight,\n      width: window.innerWidth\n    });\n\n    if (token != undefined && token != null && token != false) {\n      getUnreadUsersChatsNumber({}, token).then(data => {\n        setNumberOfChatsNotRead(data.data.data);\n      }).catch(error => {\n        console.log(error);\n      });\n    }\n  }, []);\n  const [openOrCloseNotif, setOpenOrCloseNotif] = React.useState(false);\n\n  const openMenuProfile = () => {\n    setOpenMenuProfile(true);\n  };\n\n  const closeMenuProfile = () => {\n    setOpenMenuProfile(false);\n  };\n\n  const openMenuProfileonClick = () => {\n    setOpenMenuProfile(e => !e);\n  };\n\n  const OpensearchUsers = e => {\n    setDisplaySearch({\n      state: true,\n      userName: \"\"\n    }); //\n  };\n\n  const SearchUserFn = e => {\n    setDisplaySearch({\n      state: true,\n      userName: e.target.value\n    });\n  };\n\n  const closeSearchUser = e => {\n    setTimeout(() => {\n      setDisplaySearch({\n        state: false,\n        userName: \"\"\n      });\n    }, 300);\n  };\n\n  const openOrCloseNotifications = () => {\n    setOpenOrCloseNotif(e => !e);\n  };\n\n  const ShowSideNavBar = () => {\n    sideNavBarBtn.current.classList.toggle(Style.change);\n    setShowSideNavBar(e => !e);\n  };\n\n  if (heightAndWidthOfWindow.width > heightAndWidthOfWindow.height) {\n    return /*#__PURE__*/_jsx(\"div\", {\n      className: Style.container,\n      children: /*#__PURE__*/_jsxs(\"nav\", {\n        className: Style.nav,\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: Style.Logo,\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              children: \"SPAKSI\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Search,\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: Style.flexItems,\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onBlur: () => closeSearchUser(),\n              onFocus: e => OpensearchUsers(e),\n              children: [disyplaySearch.state && /*#__PURE__*/_jsx(SearchUser, {\n                token: token,\n                searchUserName: disyplaySearch.userName\n              }), /*#__PURE__*/_jsx(\"input\", {\n                name: \"search\",\n                type: \"text\",\n                placeholder: \"Search accounts\",\n                autoComplete: \"off\",\n                onChange: e => SearchUserFn(e)\n              }), /*#__PURE__*/_jsx(\"span\", {}), /*#__PURE__*/_jsx(\"div\", {\n                className: Style.searchImg,\n                children: /*#__PURE__*/_jsx(\"svg\", {\n                  width: \"25\",\n                  height: \"20\",\n                  viewBox: \"0 0 28 38\",\n                  fill: \"rgba(22, 24, 35, 0.75)\",\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  children: /*#__PURE__*/_jsx(\"path\", {\n                    d: \"M27.6192 32.3156L22.1665 25.0378C21.9204 24.7094 21.5867 24.5269 21.2367 24.5269H20.3452C21.8547 21.9501 22.7517 18.709 22.7517 15.1833C22.7517 6.79599 17.6599 0 11.3758 0C5.09178 0 0 6.79599 0 15.1833C0 23.5706 5.09178 30.3666 11.3758 30.3666C14.0174 30.3666 16.4457 29.1695 18.3763 27.1547V28.3446C18.3763 28.8118 18.5131 29.2571 18.7592 29.5855L24.2119 36.8633C24.726 37.5495 25.5573 37.5495 26.066 36.8633L27.6137 34.7975C28.1278 34.1113 28.1278 33.0018 27.6192 32.3156ZM11.3758 24.5269C7.50914 24.5269 4.37532 20.3515 4.37532 15.1833C4.37532 10.0224 7.50367 5.83973 11.3758 5.83973C15.2425 5.83973 18.3763 10.0151 18.3763 15.1833C18.3763 20.3442 15.248 24.5269 11.3758 24.5269Z\",\n                    fill: \"rgba(22, 24, 35, 0.75)\"\n                  })\n                })\n              })]\n            })\n          })\n        }), token && /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.authenticated,\n          children: [/*#__PURE__*/_jsx(Chat, {\n            popUpUser: popUpUser,\n            numberOfChatsNotRead: numberOfChatsNotRead\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.notification,\n            onClick: () => openOrCloseNotifications(),\n            children: [openOrCloseNotif && /*#__PURE__*/_jsx(Notification, {\n              token: token\n            }), popUpNotif != 0 && /*#__PURE__*/_jsx(\"div\", {\n              className: Style.numberOfNotificationNotReadlocal,\n              children: /*#__PURE__*/_jsx(\"span\", {\n                children: popUpNotif\n              })\n            }), /*#__PURE__*/_jsx(\"svg\", {\n              width: \"25\",\n              height: \"25\",\n              viewBox: \"0 0 50 50\",\n              fill: \"black\",\n              xmlns: \"http://www.w3.org/2000/svg\",\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"M43.75 0H6.25C2.80273 0 0 2.80273 0 6.25V34.375C0 37.8223 2.80273 40.625 6.25 40.625H15.625V48.8281C15.625 49.5215 16.1914 50 16.7969 50C17.0312 50 17.2754 49.9316 17.4902 49.7656L29.6875 40.625H43.75C47.1973 40.625 50 37.8223 50 34.375V6.25C50 2.80273 47.1973 0 43.75 0ZM45.3125 34.375C45.3125 35.2344 44.6094 35.9375 43.75 35.9375H28.125L26.875 36.875L20.3125 41.7969V35.9375H6.25C5.39062 35.9375 4.6875 35.2344 4.6875 34.375V6.25C4.6875 5.39062 5.39062 4.6875 6.25 4.6875H43.75C44.6094 4.6875 45.3125 5.39062 45.3125 6.25V34.375Z\",\n                fill: \"black\"\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.profile,\n            onClick: () => openMenuProfileonClick(),\n            onMouseLeave: () => closeMenuProfile(),\n            onMouseEnter: () => openMenuProfile(),\n            children: [user != null && /*#__PURE__*/_jsx(\"div\", {\n              className: Style.navBarImageContainer,\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: user.currentImageUrl || \"/avatar.png\"\n              })\n            }), openMenuProfileState && /*#__PURE__*/_jsx(PorfileMenu, {})]\n          })]\n        }), !token && /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Nonauthenticated,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/signin\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: \"Log In\"\n              })\n            })\n          })\n        })]\n      })\n    });\n  } else\n    /*mobile */\n    return /*#__PURE__*/_jsx(\"div\", {\n      className: Style.container,\n      children: /*#__PURE__*/_jsxs(\"nav\", {\n        className: Style.nav,\n        children: [token && /*#__PURE__*/_jsxs(\"div\", {\n          style: {\n            flex: \"1 !important\"\n          },\n          className: Style.authenticated,\n          children: [/*#__PURE__*/_jsx(SideNavBar, {\n            user: user,\n            token: token,\n            showSideNavBar: showSideNavBar,\n            numberOfChatsNotRead: numberOfChatsNotRead\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.containerBtnSideNavBar,\n            ref: sideNavBarBtn,\n            onClick: () => ShowSideNavBar(),\n            children: [/*#__PURE__*/_jsx(\"div\", {\n              className: Style.bar1\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: Style.bar2\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: Style.bar3\n            })]\n          })]\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Search,\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: Style.flexItems,\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onBlur: () => closeSearchUser(),\n              onFocus: e => OpensearchUsers(e),\n              children: [disyplaySearch.state && /*#__PURE__*/_jsx(SearchUser, {\n                popUpNotif: popUpNotif,\n                token: token,\n                searchUserName: disyplaySearch.userName\n              }), /*#__PURE__*/_jsx(\"input\", {\n                name: \"search\",\n                type: \"text\",\n                placeholder: \"Search accounts\",\n                autoComplete: \"off\",\n                onChange: e => SearchUserFn(e)\n              }), /*#__PURE__*/_jsx(\"span\", {}), /*#__PURE__*/_jsx(\"div\", {\n                className: Style.searchImg,\n                children: /*#__PURE__*/_jsx(\"svg\", {\n                  width: \"20\",\n                  height: \"20\",\n                  viewBox: \"0 0 28 38\",\n                  fill: \"black\",\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  children: /*#__PURE__*/_jsx(\"path\", {\n                    d: \"M27.6192 32.3156L22.1665 25.0378C21.9204 24.7094 21.5867 24.5269 21.2367 24.5269H20.3452C21.8547 21.9501 22.7517 18.709 22.7517 15.1833C22.7517 6.79599 17.6599 0 11.3758 0C5.09178 0 0 6.79599 0 15.1833C0 23.5706 5.09178 30.3666 11.3758 30.3666C14.0174 30.3666 16.4457 29.1695 18.3763 27.1547V28.3446C18.3763 28.8118 18.5131 29.2571 18.7592 29.5855L24.2119 36.8633C24.726 37.5495 25.5573 37.5495 26.066 36.8633L27.6137 34.7975C28.1278 34.1113 28.1278 33.0018 27.6192 32.3156ZM11.3758 24.5269C7.50914 24.5269 4.37532 20.3515 4.37532 15.1833C4.37532 10.0224 7.50367 5.83973 11.3758 5.83973C15.2425 5.83973 18.3763 10.0151 18.3763 15.1833C18.3763 20.3442 15.248 24.5269 11.3758 24.5269Z\",\n                    fill: \"black\"\n                  })\n                })\n              })]\n            })\n          })\n        }), !token && /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Nonauthenticated,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/signin\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: \"Log In\"\n              })\n            })\n          })\n        })]\n      })\n    });\n};\n\nexport default NavBar;\n\nconst Chat = props => {\n  const [numberOfChatsNotReadlocal, setNumberOfChatsNotRead] = React.useState(0);\n  const [userWhoSentYouImage, setUserWhoSentYouImage] = React.useState(null);\n  React.useEffect(() => {\n    setNumberOfChatsNotRead(props.numberOfChatsNotRead);\n  }, [props.numberOfChatsNotRead]);\n  React.useEffect(() => {\n    if (props.popUpUser != undefined) {\n      setTimeout(() => {\n        setUserWhoSentYouImage(null);\n      }, 2000);\n      setUserWhoSentYouImage(props.popUpUser.currentImageUrl);\n    }\n  }, [props]);\n  return /*#__PURE__*/_jsx(Link, {\n    href: \"/chat\",\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.chatSvg,\n      children: [userWhoSentYouImage != null && /*#__PURE__*/_jsx(\"div\", {\n        className: Style.showTemImageOfUserWhoSentYouMessage,\n        children: /*#__PURE__*/_jsx(\"img\", {\n          src: userWhoSentYouImage\n        })\n      }), numberOfChatsNotReadlocal != 0 && /*#__PURE__*/_jsx(\"div\", {\n        className: Style.numberOfChatsNotReadlocal,\n        children: /*#__PURE__*/_jsx(\"span\", {\n          children: numberOfChatsNotReadlocal\n        })\n      }), /*#__PURE__*/_jsx(\"svg\", {\n        width: \"10\",\n        height: \"10\",\n        viewBox: \"100 -0 300.011 500.011\",\n        fill: \"black\",\n        xmlns: \"http://www.w3.org/2000/svg\",\n        children: /*#__PURE__*/_jsx(\"path\", {\n          d: \"M438.731,209.463l-416-192c-6.624-3.008-14.528-1.216-19.136,4.48c-4.64,5.696-4.8,13.792-0.384,19.648l136.8,182.4    l-136.8,182.4c-4.416,5.856-4.256,13.984,0.352,19.648c3.104,3.872,7.744,5.952,12.448,5.952c2.272,0,4.544-0.48,6.688-1.472    l416-192c5.696-2.624,9.312-8.288,9.312-14.528S444.395,212.087,438.731,209.463z\"\n        })\n      })]\n    })\n  });\n};\n\nconst SideNavBar = props => {\n  //props.user.currentImageUrl\n  //props.user\n  const removeCookie = userid => {\n    fetch(\"/api/logout\", {\n      method: \"post\",\n      headers: {\n        \"Content-Type\": \"application/json\"\n      }\n    }).then(() => {\n      removeToken(userid).then();\n      location.reload();\n    });\n  };\n\n  return /*#__PURE__*/_jsx(\"div\", {\n    style: props.showSideNavBar ? {\n      marginLeft: \"0\"\n    } : {\n      marginLeft: \"-100%\"\n    },\n    className: Style.sideBarContainer,\n    children: /*#__PURE__*/_jsxs(\"ul\", {\n      children: [/*#__PURE__*/_jsx(Link, {\n        href: \"/profile\",\n        children: /*#__PURE__*/_jsxs(\"li\", {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: Style.userImageInSideNavBar,\n            children: /*#__PURE__*/_jsx(\"img\", {\n              src: props.user.currentImageUrl\n            })\n          }), /*#__PURE__*/_jsx(\"p\", {\n            children: props.user.userName\n          })]\n        })\n      }), /*#__PURE__*/_jsx(Link, {\n        href: \"/chat\",\n        children: /*#__PURE__*/_jsxs(\"li\", {\n          children: [/*#__PURE__*/_jsx(\"div\", {\n            className: Style.iconSideNavBar,\n            children: /*#__PURE__*/_jsx(Chat, {\n              numberOfChatsNotRead: props.numberOfChatsNotRead\n            })\n          }), \" \", /*#__PURE__*/_jsx(\"p\", {\n            children: \"Messages\"\n          })]\n        })\n      }), /*#__PURE__*/_jsxs(\"li\", {\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Style.iconSideNavBar,\n          children: /*#__PURE__*/_jsx(\"svg\", {\n            width: \"25\",\n            height: \"25\",\n            viewBox: \"0 0 50 50\",\n            fill: \"black\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            children: /*#__PURE__*/_jsx(\"path\", {\n              d: \"M43.75 0H6.25C2.80273 0 0 2.80273 0 6.25V34.375C0 37.8223 2.80273 40.625 6.25 40.625H15.625V48.8281C15.625 49.5215 16.1914 50 16.7969 50C17.0312 50 17.2754 49.9316 17.4902 49.7656L29.6875 40.625H43.75C47.1973 40.625 50 37.8223 50 34.375V6.25C50 2.80273 47.1973 0 43.75 0ZM45.3125 34.375C45.3125 35.2344 44.6094 35.9375 43.75 35.9375H28.125L26.875 36.875L20.3125 41.7969V35.9375H6.25C5.39062 35.9375 4.6875 35.2344 4.6875 34.375V6.25C4.6875 5.39062 5.39062 4.6875 6.25 4.6875H43.75C44.6094 4.6875 45.3125 5.39062 45.3125 6.25V34.375Z\",\n              fill: \"black\"\n            })\n          })\n        }), \" \", /*#__PURE__*/_jsx(\"p\", {\n          children: \"Notification\"\n        })]\n      }), /*#__PURE__*/_jsxs(\"li\", {\n        onClick: () => removeCookie(props.user._id),\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Style.iconSideNavBar,\n          children: /*#__PURE__*/_jsxs(\"svg\", {\n            width: \"25\",\n            height: \"25\",\n            viewBox: \"0 0 25 25\",\n            fill: \"black\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            children: [/*#__PURE__*/_jsx(\"g\", {\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"m13.5 21h-4c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h4c.827 0 1.5-.673 1.5-1.5v-5c0-.276.224-.5.5-.5s.5.224.5.5v5c0 1.378-1.121 2.5-2.5 2.5z\"\n              })\n            }), /*#__PURE__*/_jsx(\"g\", {\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"m23.5 11h-10c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h10c.276 0 .5.224.5.5s-.224.5-.5.5z\"\n              })\n            }), /*#__PURE__*/_jsx(\"g\", {\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"m8 24c-.22 0-.435-.037-.638-.109l-5.99-1.997c-.82-.273-1.372-1.035-1.372-1.894v-18c0-1.103.897-2 2-2 .222 0 .438.037.639.11l5.989 1.996c.82.272 1.372 1.034 1.372 1.894v18c0 1.103-.897 2-2 2zm-6-23c-.552 0-1 .449-1 1v18c0 .428.276.808.688.946l6 2c.656.233 1.312-.292 1.312-.946v-18c0-.429-.276-.809-.688-.945l-6-2c-.103-.037-.208-.055-.312-.055z\"\n              })\n            }), /*#__PURE__*/_jsx(\"g\", {\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"m15.5 8c-.276 0-.5-.224-.5-.5v-5c0-.827-.673-1.5-1.5-1.5h-11.5c-.276 0-.5-.224-.5-.5s.224-.5.5-.5h11.5c1.379 0 2.5 1.122 2.5 2.5v5c0 .276-.224.5-.5.5z\"\n              })\n            }), /*#__PURE__*/_jsx(\"g\", {\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"m19.5 15c-.128 0-.256-.049-.354-.146-.195-.195-.195-.512 0-.707l3.646-3.646-3.646-3.646c-.195-.195-.195-.512 0-.707s.512-.195.707 0l4 4c.195.195.195.512 0 .707l-4 4c-.097.096-.225.145-.353.145z\"\n              })\n            })]\n          })\n        }), \"  \", /*#__PURE__*/_jsx(\"p\", {\n          children: \"Log Out\"\n        })]\n      })]\n    })\n  });\n};","map":null,"metadata":{},"sourceType":"module"}