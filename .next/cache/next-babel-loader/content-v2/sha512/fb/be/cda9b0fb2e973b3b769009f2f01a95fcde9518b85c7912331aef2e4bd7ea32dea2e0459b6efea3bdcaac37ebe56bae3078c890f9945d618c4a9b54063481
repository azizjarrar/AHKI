{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport _regeneratorRuntime from \"F:/AHKI/node_modules/@babel/runtime/regenerator\";\nimport _defineProperty from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _asyncToGenerator from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState } from 'react';\nimport Style from './NavBar.module.scss';\nimport ModalSingInSingUp from '../modalSingInSingUp/ModalSingInSingUp';\nimport PorfileMenu from '../profileMenu/profileMenu';\nimport Link from 'next/link';\nimport UserContext from '../../context/userContext';\nimport SearchUser from '../../components/searchUser/searchUser';\nimport { useRouter } from 'next/router';\nimport Notification from '../../components/notification/notification';\nimport { getUnreadUsersChatsNumber } from '../../services/chat';\nimport socketContext from '../../context/socketContext';\nimport { GetOtherUsersData } from '../../services/user';\n\nvar NavBar = function NavBar(_ref) {\n  var token = _ref.token;\n\n  var _useState = useState(false),\n      modalSingInSingUp = _useState[0],\n      setModalSingInSingUp = _useState[1]; //open modal\n\n\n  var _React$useState = React.useState({\n    width: '',\n    height: ''\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      heightAndWidthOfWindow = _React$useState2[0],\n      setHeightAndWidthOfWindow = _React$useState2[1]; //responsive handler\n\n\n  var _useState2 = useState(false),\n      openMenuProfileState = _useState2[0],\n      setOpenMenuProfile = _useState2[1]; //on hover profile pic open menu\n\n\n  var _React$useState3 = React.useState({\n    state: false,\n    userName: \"\"\n  }),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      disyplaySearch = _React$useState4[0],\n      setDisplaySearch = _React$useState4[1];\n\n  var _React$useContext = React.useContext(UserContext),\n      _React$useContext2 = _slicedToArray(_React$useContext, 2),\n      user = _React$useContext2[0],\n      setUser = _React$useContext2[1];\n\n  var _React$useState5 = React.useState(0),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      numberOfChatsNotRead = _React$useState6[0],\n      setNumberOfChatsNotRead = _React$useState6[1];\n\n  var _React$useContext3 = React.useContext(socketContext),\n      _React$useContext4 = _slicedToArray(_React$useContext3, 2),\n      socket = _React$useContext4[0],\n      setSocket = _React$useContext4[1];\n\n  var _React$useState7 = React.useState(null),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      popUpUser = _React$useState8[0],\n      setPopUpUser = _React$useState8[1];\n\n  var _React$useState9 = React.useState(function () {\n    return 0;\n  }),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      popUpNotif = _React$useState10[0],\n      setpopUpNotif = _React$useState10[1];\n\n  var router = useRouter();\n  React.useEffect(function () {\n    function chatHandler(_x) {\n      return _chatHandler.apply(this, arguments);\n    }\n\n    function _chatHandler() {\n      _chatHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n        var audio;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                audio = new Audio(\"./msgSound.mp3\");\n                audio.play();\n\n                if (router.pathname != \"/chat\") {\n                  GetOtherUsersData(data.senderId, token).then(function (result) {\n                    setPopUpUser(_objectSpread({}, result.data.data[0]));\n                  })[\"catch\"](function (error) {\n                    alert(error);\n                  });\n                }\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _chatHandler.apply(this, arguments);\n    }\n\n    function notifHandler(_x2) {\n      return _notifHandler.apply(this, arguments);\n    }\n\n    function _notifHandler() {\n      _notifHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data) {\n        return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                if (data.notif == 1) {\n                  setpopUpNotif(function (e) {\n                    return e + 1;\n                  });\n                }\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2);\n      }));\n      return _notifHandler.apply(this, arguments);\n    }\n\n    if (socket != undefined && socket != null) {\n      socket.on(\"getMessageFromUserToUser\", chatHandler);\n      socket.on(\"getNotificationFromUserToUser\", notifHandler);\n    }\n\n    return function () {\n      if (socket != undefined && socket != null) {\n        socket.off('getMessageFromUserToUser', chatHandler);\n        socket.off('getNotificationFromUserToUser', notifHandler);\n      }\n    };\n  });\n  React.useEffect(function () {\n    if (token != undefined && token != null && token != false) {\n      setHeightAndWidthOfWindow({\n        height: window.innerHeight,\n        width: window.innerWidth\n      });\n      getUnreadUsersChatsNumber({}, token).then(function (data) {\n        setNumberOfChatsNotRead(data.data.data);\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  }, []);\n\n  var _React$useState11 = React.useState(false),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      openOrCloseNotif = _React$useState12[0],\n      setOpenOrCloseNotif = _React$useState12[1];\n\n  var openMenuProfile = function openMenuProfile() {\n    setOpenMenuProfile(true);\n  };\n\n  var closeMenuProfile = function closeMenuProfile() {\n    setOpenMenuProfile(false);\n  };\n\n  var openMenuProfileonClick = function openMenuProfileonClick() {\n    setOpenMenuProfile(function (e) {\n      return !e;\n    });\n  };\n\n  var OpensearchUsers = function OpensearchUsers(e) {\n    setDisplaySearch({\n      state: true,\n      userName: \"\"\n    }); //\n  };\n\n  var SearchUserFn = function SearchUserFn(e) {\n    setDisplaySearch({\n      state: true,\n      userName: e.target.value\n    });\n  };\n\n  var closeSearchUser = function closeSearchUser(e) {\n    setTimeout(function () {\n      setDisplaySearch({\n        state: false,\n        userName: \"\"\n      });\n    }, 300);\n  };\n\n  var openOrCloseNotifications = function openOrCloseNotifications() {\n    setOpenOrCloseNotif(function (e) {\n      return !e;\n    });\n  };\n\n  if (heightAndWidthOfWindow.width > heightAndWidthOfWindow.height) {\n    return /*#__PURE__*/_jsx(\"div\", {\n      className: Style.container,\n      children: /*#__PURE__*/_jsxs(\"nav\", {\n        className: Style.nav,\n        children: [/*#__PURE__*/_jsx(Link, {\n          href: \"/\",\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: Style.Logo,\n            children: /*#__PURE__*/_jsx(\"h1\", {\n              children: \"SPAKSI\"\n            })\n          })\n        }), /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Search,\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: Style.flexItems,\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onBlur: function onBlur() {\n                return closeSearchUser();\n              },\n              onFocus: function onFocus(e) {\n                return OpensearchUsers(e);\n              },\n              children: [disyplaySearch.state && /*#__PURE__*/_jsx(SearchUser, {\n                token: token,\n                searchUserName: disyplaySearch.userName\n              }), /*#__PURE__*/_jsx(\"input\", {\n                name: \"search\",\n                type: \"text\",\n                placeholder: \"Search accounts\",\n                autoComplete: \"off\",\n                onChange: function onChange(e) {\n                  return SearchUserFn(e);\n                }\n              }), /*#__PURE__*/_jsx(\"span\", {}), /*#__PURE__*/_jsx(\"div\", {\n                className: Style.searchImg,\n                children: /*#__PURE__*/_jsx(\"svg\", {\n                  width: \"20\",\n                  height: \"20\",\n                  viewBox: \"0 0 28 38\",\n                  fill: \"#1876f3\",\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  children: /*#__PURE__*/_jsx(\"path\", {\n                    d: \"M27.6192 32.3156L22.1665 25.0378C21.9204 24.7094 21.5867 24.5269 21.2367 24.5269H20.3452C21.8547 21.9501 22.7517 18.709 22.7517 15.1833C22.7517 6.79599 17.6599 0 11.3758 0C5.09178 0 0 6.79599 0 15.1833C0 23.5706 5.09178 30.3666 11.3758 30.3666C14.0174 30.3666 16.4457 29.1695 18.3763 27.1547V28.3446C18.3763 28.8118 18.5131 29.2571 18.7592 29.5855L24.2119 36.8633C24.726 37.5495 25.5573 37.5495 26.066 36.8633L27.6137 34.7975C28.1278 34.1113 28.1278 33.0018 27.6192 32.3156ZM11.3758 24.5269C7.50914 24.5269 4.37532 20.3515 4.37532 15.1833C4.37532 10.0224 7.50367 5.83973 11.3758 5.83973C15.2425 5.83973 18.3763 10.0151 18.3763 15.1833C18.3763 20.3442 15.248 24.5269 11.3758 24.5269Z\",\n                    fill: \"#b0b0b5\"\n                  })\n                })\n              })]\n            })\n          })\n        }), token && /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.authenticated,\n          children: [/*#__PURE__*/_jsx(Chat, {\n            popUpUser: popUpUser,\n            numberOfChatsNotRead: numberOfChatsNotRead\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.notification,\n            onClick: function onClick() {\n              return openOrCloseNotifications();\n            },\n            children: [openOrCloseNotif && /*#__PURE__*/_jsx(Notification, {\n              token: token\n            }), /*#__PURE__*/_jsx(\"div\", {\n              className: Style.numberOfNotificationNotReadlocal,\n              children: /*#__PURE__*/_jsx(\"span\", {\n                children: popUpNotif\n              })\n            }), /*#__PURE__*/_jsx(\"svg\", {\n              width: \"35\",\n              height: \"35\",\n              viewBox: \"0 0 50 50\",\n              fill: \"#1876f3\",\n              xmlns: \"http://www.w3.org/2000/svg\",\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"M43.75 0H6.25C2.80273 0 0 2.80273 0 6.25V34.375C0 37.8223 2.80273 40.625 6.25 40.625H15.625V48.8281C15.625 49.5215 16.1914 50 16.7969 50C17.0312 50 17.2754 49.9316 17.4902 49.7656L29.6875 40.625H43.75C47.1973 40.625 50 37.8223 50 34.375V6.25C50 2.80273 47.1973 0 43.75 0ZM45.3125 34.375C45.3125 35.2344 44.6094 35.9375 43.75 35.9375H28.125L26.875 36.875L20.3125 41.7969V35.9375H6.25C5.39062 35.9375 4.6875 35.2344 4.6875 34.375V6.25C4.6875 5.39062 5.39062 4.6875 6.25 4.6875H43.75C44.6094 4.6875 45.3125 5.39062 45.3125 6.25V34.375Z\",\n                fill: \"#1876f3\"\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.profile,\n            onClick: function onClick() {\n              return openMenuProfileonClick();\n            },\n            onMouseLeave: function onMouseLeave() {\n              return closeMenuProfile();\n            },\n            onMouseEnter: function onMouseEnter() {\n              return openMenuProfile();\n            },\n            children: [user != null && /*#__PURE__*/_jsx(\"div\", {\n              className: Style.navBarImageContainer,\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: user.currentImageUrl || \"/avatar.png\"\n              })\n            }), openMenuProfileState && /*#__PURE__*/_jsx(PorfileMenu, {})]\n          })]\n        }), !token && /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Nonauthenticated,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/signin\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: \"Log In\"\n              })\n            })\n          })\n        })]\n      })\n    });\n  } else\n    /*mobile */\n    return /*#__PURE__*/_jsx(\"div\", {\n      className: Style.container,\n      children: /*#__PURE__*/_jsxs(\"nav\", {\n        className: Style.nav,\n        children: [/*#__PURE__*/_jsx(\"div\", {\n          className: Style.Search,\n          children: /*#__PURE__*/_jsx(\"div\", {\n            className: Style.flexItems,\n            children: /*#__PURE__*/_jsxs(\"form\", {\n              onBlur: function onBlur() {\n                return closeSearchUser();\n              },\n              onFocus: function onFocus(e) {\n                return OpensearchUsers(e);\n              },\n              children: [disyplaySearch.state && /*#__PURE__*/_jsx(SearchUser, {\n                token: token,\n                searchUserName: disyplaySearch.userName\n              }), /*#__PURE__*/_jsx(\"input\", {\n                name: \"search\",\n                type: \"text\",\n                autoComplete: \"off\",\n                placeholder: \"Search accounts\",\n                onChange: function onChange(e) {\n                  return SearchUserFn(e);\n                }\n              }), /*#__PURE__*/_jsx(\"span\", {}), /*#__PURE__*/_jsx(\"div\", {\n                className: Style.searchImg,\n                children: /*#__PURE__*/_jsx(\"svg\", {\n                  width: \"20\",\n                  height: \"20\",\n                  viewBox: \"0 0 28 38\",\n                  fill: \"#1876f3\",\n                  xmlns: \"http://www.w3.org/2000/svg\",\n                  children: /*#__PURE__*/_jsx(\"path\", {\n                    d: \"M27.6192 32.3156L22.1665 25.0378C21.9204 24.7094 21.5867 24.5269 21.2367 24.5269H20.3452C21.8547 21.9501 22.7517 18.709 22.7517 15.1833C22.7517 6.79599 17.6599 0 11.3758 0C5.09178 0 0 6.79599 0 15.1833C0 23.5706 5.09178 30.3666 11.3758 30.3666C14.0174 30.3666 16.4457 29.1695 18.3763 27.1547V28.3446C18.3763 28.8118 18.5131 29.2571 18.7592 29.5855L24.2119 36.8633C24.726 37.5495 25.5573 37.5495 26.066 36.8633L27.6137 34.7975C28.1278 34.1113 28.1278 33.0018 27.6192 32.3156ZM11.3758 24.5269C7.50914 24.5269 4.37532 20.3515 4.37532 15.1833C4.37532 10.0224 7.50367 5.83973 11.3758 5.83973C15.2425 5.83973 18.3763 10.0151 18.3763 15.1833C18.3763 20.3442 15.248 24.5269 11.3758 24.5269Z\",\n                    fill: \"#1876f3\"\n                  })\n                })\n              })]\n            })\n          })\n        }), token && /*#__PURE__*/_jsxs(\"div\", {\n          className: Style.authenticated,\n          children: [/*#__PURE__*/_jsxs(\"div\", {\n            className: Style.notification,\n            onClick: function onClick() {\n              return openOrCloseNotifications();\n            },\n            children: [openOrCloseNotif && /*#__PURE__*/_jsx(Notification, {\n              token: token\n            }), /*#__PURE__*/_jsx(\"svg\", {\n              width: \"35\",\n              height: \"35\",\n              viewBox: \"0 0 50 50\",\n              fill: \"#1876f3\",\n              xmlns: \"http://www.w3.org/2000/svg\",\n              children: /*#__PURE__*/_jsx(\"path\", {\n                d: \"M43.75 0H6.25C2.80273 0 0 2.80273 0 6.25V34.375C0 37.8223 2.80273 40.625 6.25 40.625H15.625V48.8281C15.625 49.5215 16.1914 50 16.7969 50C17.0312 50 17.2754 49.9316 17.4902 49.7656L29.6875 40.625H43.75C47.1973 40.625 50 37.8223 50 34.375V6.25C50 2.80273 47.1973 0 43.75 0ZM45.3125 34.375C45.3125 35.2344 44.6094 35.9375 43.75 35.9375H28.125L26.875 36.875L20.3125 41.7969V35.9375H6.25C5.39062 35.9375 4.6875 35.2344 4.6875 34.375V6.25C4.6875 5.39062 5.39062 4.6875 6.25 4.6875H43.75C44.6094 4.6875 45.3125 5.39062 45.3125 6.25V34.375Z\",\n                fill: \"#1876f3\"\n              })\n            })]\n          }), /*#__PURE__*/_jsxs(\"div\", {\n            className: Style.profile,\n            onClick: function onClick() {\n              return openMenuProfileonClick();\n            },\n            onMouseLeave: function onMouseLeave() {\n              return closeMenuProfile();\n            },\n            onMouseEnter: function onMouseEnter() {\n              return openMenuProfile();\n            },\n            children: [openMenuProfileState && /*#__PURE__*/_jsx(PorfileMenu, {}), \" \", user != null && /*#__PURE__*/_jsx(\"div\", {\n              className: Style.navBarImageContainer,\n              children: /*#__PURE__*/_jsx(\"img\", {\n                src: user.currentImageUrl || \"/avatar.png\"\n              })\n            })]\n          })]\n        }), !token && /*#__PURE__*/_jsx(\"div\", {\n          className: Style.Nonauthenticated,\n          children: /*#__PURE__*/_jsx(Link, {\n            href: \"/signin\",\n            children: /*#__PURE__*/_jsx(\"button\", {\n              children: /*#__PURE__*/_jsx(\"p\", {\n                children: \"Log In\"\n              })\n            })\n          })\n        })]\n      })\n    });\n};\n\nexport default NavBar;\n\nvar Chat = function Chat(props) {\n  var _React$useState13 = React.useState(0),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      numberOfChatsNotReadlocal = _React$useState14[0],\n      setNumberOfChatsNotRead = _React$useState14[1];\n\n  var _React$useState15 = React.useState(null),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      userWhoSentYouImage = _React$useState16[0],\n      setUserWhoSentYouImage = _React$useState16[1];\n\n  React.useEffect(function () {\n    setNumberOfChatsNotRead(props.numberOfChatsNotRead);\n  }, [props.numberOfChatsNotRead]);\n  React.useEffect(function () {\n    if (props.popUpUser != undefined) {\n      setTimeout(function () {\n        setUserWhoSentYouImage(null);\n      }, 2000);\n      setUserWhoSentYouImage(props.popUpUser.currentImageUrl);\n    }\n  }, [props]);\n  return /*#__PURE__*/_jsx(Link, {\n    href: \"/chat\",\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: Style.chatSvg,\n      children: [userWhoSentYouImage != null && /*#__PURE__*/_jsx(\"div\", {\n        className: Style.showTemImageOfUserWhoSentYouMessage,\n        children: /*#__PURE__*/_jsx(\"img\", {\n          src: userWhoSentYouImage\n        })\n      }), /*#__PURE__*/_jsx(\"div\", {\n        className: Style.numberOfChatsNotReadlocal,\n        children: /*#__PURE__*/_jsx(\"span\", {\n          children: numberOfChatsNotReadlocal\n        })\n      }), /*#__PURE__*/_jsx(\"svg\", {\n        xmlns: \"http://www.w3.org/2000/svg\",\n        id: \"Capa_1\",\n        \"enable-background\": \"new 0 0 479.058 479.058\",\n        fill: \"#1876f3\",\n        height: \"512\",\n        viewBox: \"0 0 479.058 479.058\",\n        width: \"512\",\n        children: /*#__PURE__*/_jsx(\"path\", {\n          d: \"m434.146 59.882h-389.234c-24.766 0-44.912 20.146-44.912 44.912v269.47c0 24.766 20.146 44.912 44.912 44.912h389.234c24.766 0 44.912-20.146 44.912-44.912v-269.47c0-24.766-20.146-44.912-44.912-44.912zm0 29.941c2.034 0 3.969.422 5.738 1.159l-200.355 173.649-200.356-173.649c1.769-.736 3.704-1.159 5.738-1.159zm0 299.411h-389.234c-8.26 0-14.971-6.71-14.971-14.971v-251.648l199.778 173.141c2.822 2.441 6.316 3.655 9.81 3.655s6.988-1.213 9.81-3.655l199.778-173.141v251.649c-.001 8.26-6.711 14.97-14.971 14.97z\"\n        })\n      })]\n    })\n  });\n};","map":null,"metadata":{},"sourceType":"module"}