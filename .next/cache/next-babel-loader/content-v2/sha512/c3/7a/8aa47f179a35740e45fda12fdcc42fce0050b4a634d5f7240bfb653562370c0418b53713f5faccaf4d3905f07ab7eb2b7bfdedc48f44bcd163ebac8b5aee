{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"F:/AHKI/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _toConsumableArray from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"F:/AHKI/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\n\nvar _jsxFileName = \"F:\\\\AHKI\\\\pages\\\\chat.js\",\n    _this = this,\n    _s = $RefreshSig$(),\n    _s2 = $RefreshSig$(),\n    _s3 = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React from 'react';\nimport Style from '../styles/chat.module.scss';\nimport NavBar from '../components/navBar/NavBar';\nimport { Picker, Emoji } from 'emoji-mart';\nimport 'emoji-mart/css/emoji-mart.css';\nimport { searchUserNameApi } from '../services/user';\nimport { updateColorChat, addMessage, getMessagesOfCurrentconversation, getUserWhoChatWith } from '../services/chat';\nimport socketContext from '../context/socketContext';\nimport userContext from '../context/userContext';\n\nvar chat = function chat(props) {\n  _s();\n\n  var _React$useState = React.useState(false),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      closeOrOpenEmojiPickerState = _React$useState2[0],\n      setcloseOrOpenEmojiPickerState = _React$useState2[1];\n\n  var _React$useState3 = React.useState(9),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      EmojiContainerHeight = _React$useState4[0],\n      setEmojiContainerHeight = _React$useState4[1]; //responsive handler\n\n\n  var _React$useState5 = React.useState([]),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      listOfUsers = _React$useState6[0],\n      setListOfUsers = _React$useState6[1];\n\n  var _React$useState7 = React.useState({\n    currentImageUrl: undefined,\n    userName: undefined,\n    _id: undefined\n  }),\n      _React$useState8 = _slicedToArray(_React$useState7, 2),\n      currentUserToChatWith = _React$useState8[0],\n      setCurrentUserToChatWith = _React$useState8[1];\n\n  var _React$useState9 = React.useState(\"\"),\n      _React$useState10 = _slicedToArray(_React$useState9, 2),\n      message = _React$useState10[0],\n      setMessage = _React$useState10[1];\n\n  var _React$useState11 = React.useState([]),\n      _React$useState12 = _slicedToArray(_React$useState11, 2),\n      currentChats = _React$useState12[0],\n      setCurrentChats = _React$useState12[1];\n\n  var messagesComp = React.useRef(null);\n\n  var _React$useContext = React.useContext(userContext),\n      _React$useContext2 = _slicedToArray(_React$useContext, 2),\n      user = _React$useContext2[0],\n      setUser = _React$useContext2[1];\n\n  var _React$useContext3 = React.useContext(socketContext),\n      _React$useContext4 = _slicedToArray(_React$useContext3, 2),\n      socket = _React$useContext4[0],\n      setSocket = _React$useContext4[1];\n\n  var _React$useState13 = React.useState(function () {\n    return 0;\n  }),\n      _React$useState14 = _slicedToArray(_React$useState13, 2),\n      skip = _React$useState14[0],\n      setSkip = _React$useState14[1];\n\n  var _React$useState15 = React.useState(false),\n      _React$useState16 = _slicedToArray(_React$useState15, 2),\n      isWritingState = _React$useState16[0],\n      setIsWritingState = _React$useState16[1];\n\n  var _React$useState17 = React.useState({\n    colorone: \"#1876f3\",\n    colortwo: \"#e4e6eb\"\n  }),\n      _React$useState18 = _slicedToArray(_React$useState17, 2),\n      chatColor = _React$useState18[0],\n      setChatColor = _React$useState18[1];\n\n  var _React$useState19 = React.useState({\n    width: 0,\n    height: 0\n  }),\n      _React$useState20 = _slicedToArray(_React$useState19, 2),\n      heightAndWidthOfWindow = _React$useState20[0],\n      setHeightAndWidthOfWindow = _React$useState20[1]; //responsive handler\n\n  /**********************************/\n\n  /*************useEffects***********/\n\n  /**********************************/\n\n\n  React.useEffect(function () {\n    setHeightAndWidthOfWindow({\n      height: window.innerHeight,\n      width: window.innerWidth\n    });\n  }, []); //when you scrol top on convertation it will load new 20 message\n\n  React.useEffect(function () {\n    if (currentUserToChatWith._id != undefined) {\n      getMessagesOfCurrentconversation({\n        secondUser: currentUserToChatWith._id,\n        skip: skip\n      }, props.token).then(function (data) {\n        setCurrentChats(function (e) {\n          return [].concat(_toConsumableArray(data.data.data.reverse()), _toConsumableArray(e));\n        });\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  }, [skip]); // get list of users  you chat with\n\n  React.useEffect(function () {\n    if (user._id != undefined && user._id.length > 2) getUserWhoChatWith({}, props.token).then(function (result) {\n      var newUserWhoChatWith = result.data.data.map(function (e) {\n        //this to return the data of the other user not your data because im return both of data sender and reciver \n        if (e.firstUser._id == user._id) {\n          return Promise.resolve(_objectSpread(_objectSpread({}, e.secoundUser), {}, {\n            color: e.color,\n            notSeenMessageNumber: e.notSeenMessageNumber\n          }));\n        } else {\n          return Promise.resolve(_objectSpread(_objectSpread({}, e.firstUser), {}, {\n            color: e.color,\n            notSeenMessageNumber: e.notSeenMessageNumber\n          }));\n        }\n      });\n      Promise.all(newUserWhoChatWith).then(function (newarray) {\n        setListOfUsers(_toConsumableArray(newarray));\n      });\n    })[\"catch\"](function (e) {\n      return console.log(e.message);\n    });\n  }, [user]); //when you click on user it will load convertation data\n\n  React.useEffect(function () {\n    if (currentUserToChatWith._id != undefined) {\n      getMessagesOfCurrentconversation({\n        secondUser: currentUserToChatWith._id,\n        skip: 0\n      }, props.token).then(function (data) {\n        setCurrentChats(_toConsumableArray(data.data.data.reverse()));\n        messagesComp.current.scrollTop = messagesComp.current.scrollHeight + messagesComp.current.clientHeight;\n      })[\"catch\"](function (error) {\n        console.log(error);\n      }); //when you open convertation its will make all messgage seen\n\n      socket.emit(\"vu\", {\n        state: true,\n        otherUserId: currentUserToChatWith._id\n      });\n    }\n  }, [currentUserToChatWith]); //socket receving data handler\n\n  React.useEffect(function () {\n    //on reciving messsage socket\n    function chatHandler(_x) {\n      return _chatHandler.apply(this, arguments);\n    } //if the other user is wrting add animation if wrting\n\n\n    function _chatHandler() {\n      _chatHandler = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(data) {\n        var audio, ListOfUser;\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                audio = new Audio(\"./msgSound.mp3\");\n                audio.play();\n                setIsWritingState(false); //set vu if you are in converation \n\n                socket.emit(\"vu\", {\n                  state: true,\n                  otherUserId: currentUserToChatWith._id\n                }); //if you are not in convertion add +1 to message not read in user image\n\n                _context.next = 6;\n                return listOfUsers.map(function (e) {\n                  if (data.senderId == e._id && currentUserToChatWith._id != e._id) {\n                    e.notSeenMessageNumber = e.notSeenMessageNumber + 1;\n                    return Promise.resolve(e);\n                  } else {\n                    return Promise.resolve(e);\n                  }\n                });\n\n              case 6:\n                ListOfUser = _context.sent;\n                Promise.all(ListOfUser).then(function (data) {\n                  setListOfUsers(data);\n                }); //add message to chat\n\n                if (data.senderId == currentUserToChatWith._id) {\n                  setCurrentChats(function (e) {\n                    var r = Math.random().toString(36).substring(7);\n                    return [].concat(_toConsumableArray(e), [{\n                      users: [data.senderId],\n                      message: data.text,\n                      _id: r\n                    }]);\n                  });\n                  messagesComp.current.scrollTop = messagesComp.current.scrollHeight + messagesComp.current.clientHeight;\n                } else {}\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n      return _chatHandler.apply(this, arguments);\n    }\n\n    function isWriting(data) {\n      if (data.userWhoReciveWriting == user._id && data.senderid == currentUserToChatWith._id) {\n        setIsWritingState(data.isWriting);\n      }\n    } // if other user has seen you message seen icon will be blue\n\n\n    var setvu = function setvu(data) {\n      if (document.getElementsByClassName(Style.yourMessageVu).length != 0) {\n        for (var i = currentChats.length - 1; i > 0; i--) {\n          if (document.getElementsByClassName(Style.yourMessageVu)[i] != undefined) {\n            if (document.getElementsByClassName(Style.yourMessageVu)[i].childNodes[1].style.color != \"rgb(24, 118, 243)\") {\n              document.getElementsByClassName(Style.yourMessageVu)[i].childNodes[1].style.color = \"rgb(24, 118, 243)\";\n            }\n          }\n        }\n      }\n    };\n\n    if (socket != undefined && socket != null) {\n      socket.on(\"isWritingState\", isWriting);\n      socket.on(\"getMessageFromUserToUser\", chatHandler);\n      socket.on(\"setvu\", setvu);\n    }\n\n    return function () {\n      if (socket != undefined && socket != null) {\n        socket.off('getMessageFromUserToUser', chatHandler);\n        socket.off(\"isWritingState\", isWriting);\n        socket.off(\"setvu\", setvu);\n      }\n    };\n  }); //add emoji to input\n\n  var addEmoji = function addEmoji(e) {\n    var sym = e.unified.split('-');\n    var codesArray = [];\n    sym.forEach(function (el) {\n      return codesArray.push('0x' + el);\n    });\n    var emoji = String.fromCodePoint.apply(String, codesArray);\n    setMessage(function (el) {\n      return el + emoji;\n    });\n  }; //close or open emoji container\n\n\n  var closeOrOpenEmojiPicker = function closeOrOpenEmojiPicker() {\n    setcloseOrOpenEmojiPickerState(function (e) {\n      return !e;\n    });\n  }; //search for user to send message\n\n\n  var searchForUser = function searchForUser(e) {\n    searchUserNameApi(e.target.value, props.token).then(function (result) {\n      if (result.data.data != undefined) {\n        setListOfUsers(function (e) {\n          return _toConsumableArray(result.data.data);\n        });\n      }\n    });\n  }; //on click on user get current user data\n\n\n  var getUserdataFn = function getUserdataFn(currentUserData) {\n    setCurrentUserToChatWith(currentUserData);\n  };\n\n  var sendMessage = function sendMessage() {\n    if (message.length > 0 && currentUserToChatWith._id != undefined) {\n      addMessage({\n        receiver: currentUserToChatWith._id,\n        message: message,\n        FirstTime: currentChats.length\n      }, props.token).then(function (data) {\n        setCurrentChats(function (e) {\n          var r = Math.random().toString(36).substring(7);\n          return [].concat(_toConsumableArray(e), [{\n            users: [user._id],\n            message: message,\n            _id: r\n          }]);\n        });\n        messagesComp.current.scrollTop = messagesComp.current.scrollHeight + messagesComp.current.clientHeight;\n        socket.emit(\"sendMessageFromUserToUser\", {\n          otherUserId: currentUserToChatWith._id,\n          text: message,\n          senderId: user._id\n        });\n        setMessage(\"\");\n      })[\"catch\"](function (error) {\n        console.log(error);\n      });\n    }\n  };\n\n  var messageHandler = function messageHandler(e) {\n    if (currentUserToChatWith._id != undefined) {\n      if (e.target.value.length > 0) {\n        socket.emit(\"isWriting\", {\n          isWriting: true,\n          otherUserId: currentUserToChatWith._id,\n          senderid: user._id\n        });\n      } else {\n        socket.emit(\"isWriting\", {\n          isWriting: false,\n          otherUserId: currentUserToChatWith._id,\n          senderid: user._id\n        });\n      }\n    }\n\n    setMessage(e.target.value);\n  }; //on scrol to top load 20 new message\n\n\n  var scrollfn = function scrollfn(e) {\n    //if( e.target.scrollTop === (e.target.scrollHeight - e.target.offsetHeight)){\n    if (e.target.scrollTop === 0) {\n      setSkip(function (e) {\n        return e + 20;\n      });\n    }\n  }; //if you change the color of converation\n\n\n  var getNewColor = function getNewColor(color) {\n    setChatColor(function (e) {\n      return _objectSpread(_objectSpread({}, e), {}, {\n        colorone: color\n      });\n    });\n  }; //set color if convertation\n\n\n  var setColorOfChatFn = function setColorOfChatFn(colorOfChatFromDataBase) {\n    if (colorOfChatFromDataBase == undefined) {\n      setChatColor(function (e) {\n        return _objectSpread(_objectSpread({}, e), {}, {\n          colorone: \"#1876f3\"\n        });\n      });\n    } else {\n      setChatColor(function (e) {\n        return _objectSpread(_objectSpread({}, e), {}, {\n          colorone: colorOfChatFromDataBase\n        });\n      });\n    }\n  };\n\n  if (heightAndWidthOfWindow.width > heightAndWidthOfWindow.height) {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.container,\n      children: [/*#__PURE__*/_jsxDEV(NavBar, {\n        token: props.token\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 23\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.chatAndRandomOnlineUserContaner,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.UserContaner,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.header,\n            children: /*#__PURE__*/_jsxDEV(\"h1\", {\n              children: \"contacts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 252,\n              columnNumber: 33\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 29\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.listContacs,\n            children: listOfUsers.map(function (e) {\n              return /*#__PURE__*/_jsxDEV(Users, {\n                setColorOfChat: setColorOfChatFn,\n                getUserdata: getUserdataFn,\n                userData: e\n              }, e._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 255,\n                columnNumber: 49\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 29\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.bottom,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: Style.searchContainer,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.inputcss,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  onChange: function onChange(e) {\n                    return searchForUser(e);\n                  },\n                  type: \"text\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 100\n                }, _this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Search users\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 259,\n                    columnNumber: 176\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 259,\n                  columnNumber: 169\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 259,\n                columnNumber: 68\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 259,\n              columnNumber: 29\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 29\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 25\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.chat,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.header,\n            children: /*#__PURE__*/_jsxDEV(\"h1\", {\n              children: \"Messages\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 29\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.chatContainer,\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: Style.headerOfChatuserNameAndName,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.userImageContainer,\n                children: /*#__PURE__*/_jsxDEV(\"img\", {\n                  src: currentUserToChatWith.currentImageUrl || \"/avatar.png\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 268,\n                  columnNumber: 75\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 268,\n                columnNumber: 33\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.userName,\n                children: /*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: currentUserToChatWith.userName\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 269,\n                  columnNumber: 65\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 33\n              }, _this), isWritingState && /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.isWritingContainer,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: Style.ldsellipsis,\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 271,\n                    columnNumber: 68\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 271,\n                    columnNumber: 79\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 271,\n                    columnNumber: 90\n                  }, _this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 271,\n                    columnNumber: 101\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 271,\n                  columnNumber: 33\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 50\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.changeColorContainer,\n                children: /*#__PURE__*/_jsxDEV(ColorPicker, {\n                  receiver: currentUserToChatWith._id,\n                  token: props.token,\n                  getNewColorfn: getNewColor,\n                  chatColor: chatColor\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 273,\n                  columnNumber: 77\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 273,\n                columnNumber: 33\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 267,\n              columnNumber: 29\n            }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n              onScroll: function onScroll(e) {\n                return scrollfn(e);\n              },\n              ref: messagesComp,\n              className: Style.messages,\n              children: currentChats.map(function (e) {\n                return /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: Style.oneMessage,\n                  children: e.users[0] == currentUserToChatWith._id ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: Style.messageText,\n                    \"text-data\": e.date != undefined ? e.date.slice(0, 10) + \" \" + e.date.slice(11, 16) : \"false\",\n                    style: {\n                      \"--i\": \"0%\",\n                      \"float\": \"left\",\n                      backgroundColor: \"#e4e6eb\",\n                      color: \"black\"\n                    },\n                    children: /*#__PURE__*/_jsxDEV(\"p\", {\n                      children: e.message\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 279,\n                      columnNumber: 232\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 279,\n                    columnNumber: 41\n                  }, _this) : /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: \"\".concat(Style.messageText, \" \").concat(Style.yourMessageVu, \" \"),\n                    \"text-data\": e.date != undefined ? e.date.slice(0, 10) + \" \" + e.date.slice(11, 16) : \"false\",\n                    style: {\n                      \"--i\": \"-100%\",\n                      \"float\": \"right\",\n                      backgroundColor: chatColor.colorone,\n                      color: \"white\"\n                    },\n                    children: [/*#__PURE__*/_jsxDEV(\"p\", {\n                      children: e.message\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 280,\n                      columnNumber: 276\n                    }, _this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      style: e.seen == true ? {\n                        color: \"#1876f3\"\n                      } : {\n                        color: \"black\"\n                      },\n                      className: Style.seen,\n                      children: \"\\u2714\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 280,\n                      columnNumber: 294\n                    }, _this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 280,\n                    columnNumber: 41\n                  }, _this)\n                }, e._id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 277,\n                  columnNumber: 44\n                }, _this);\n              })\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 275,\n              columnNumber: 29\n            }, _this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 266,\n            columnNumber: 25\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.sendMessage,\n            children: /*#__PURE__*/_jsxDEV(\"form\", {\n              onSubmit: function onSubmit(e) {\n                return e.preventDefault();\n              },\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.inputContainer,\n                children: /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: Style.inputcss,\n                  children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                    value: message,\n                    onChange: function onChange(e) {\n                      return messageHandler(e);\n                    },\n                    type: \"text\",\n                    required: true\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 288,\n                    columnNumber: 99\n                  }, _this), /*#__PURE__*/_jsxDEV(\"label\", {\n                    children: /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: \"Message\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 288,\n                      columnNumber: 193\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 288,\n                    columnNumber: 186\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 288,\n                  columnNumber: 67\n                }, _this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 288,\n                columnNumber: 29\n              }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.btns,\n                children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                  className: Style.openOrCloseEmojiPicker,\n                  onClick: function onClick() {\n                    return closeOrOpenEmojiPicker();\n                  },\n                  children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                    className: Style.emojiLogo,\n                    children: /*#__PURE__*/_jsxDEV(Emoji, {\n                      emoji: {\n                        id: 'smiling_face_with_3_hearts',\n                        skin: 3\n                      },\n                      size: 16\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 291,\n                      columnNumber: 62\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 291,\n                    columnNumber: 29\n                  }, _this), closeOrOpenEmojiPickerState && /*#__PURE__*/_jsxDEV(\"div\", {\n                    className: Style.emojiPickerContainer,\n                    children: /*#__PURE__*/_jsxDEV(Picker, {\n                      perLine: EmojiContainerHeight,\n                      onSelect: function onSelect(e) {\n                        return addEmoji(e);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 292,\n                      columnNumber: 103\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 292,\n                    columnNumber: 59\n                  }, _this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 290,\n                  columnNumber: 29\n                }, _this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  type: \"submit\",\n                  className: Style.btnsend,\n                  onClick: function onClick() {\n                    return sendMessage();\n                  },\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    className: Style.sendMessageBtn,\n                    children: /*#__PURE__*/_jsxDEV(SentSvg, {}, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 294,\n                      columnNumber: 149\n                    }, _this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 294,\n                    columnNumber: 109\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 294,\n                  columnNumber: 33\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 289,\n                columnNumber: 29\n              }, _this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 287,\n              columnNumber: 29\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 286,\n            columnNumber: 25\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 25\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 21\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 246,\n      columnNumber: 13\n    }, _this);\n  } else {\n    return /*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.container,\n        children: [/*#__PURE__*/_jsxDEV(NavBar, {\n          token: props.token\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 305,\n          columnNumber: 21\n        }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.UserContanerMobile,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.header,\n            children: /*#__PURE__*/_jsxDEV(\"h1\", {\n              children: \"contacts\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 309,\n              columnNumber: 33\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 308,\n            columnNumber: 29\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.listContacs,\n            children: listOfUsers.map(function (e) {\n              return /*#__PURE__*/_jsxDEV(Users, {\n                setColorOfChat: setColorOfChatFn,\n                getUserdata: getUserdataFn,\n                userData: e\n              }, e._id, false, {\n                fileName: _jsxFileName,\n                lineNumber: 312,\n                columnNumber: 49\n              }, _this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 311,\n            columnNumber: 29\n          }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.bottom,\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: Style.searchContainer,\n              children: /*#__PURE__*/_jsxDEV(\"div\", {\n                className: Style.inputcss,\n                children: [/*#__PURE__*/_jsxDEV(\"input\", {\n                  onChange: function onChange(e) {\n                    return searchForUser(e);\n                  },\n                  type: \"text\",\n                  required: true\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 315,\n                  columnNumber: 100\n                }, _this), /*#__PURE__*/_jsxDEV(\"label\", {\n                  children: /*#__PURE__*/_jsxDEV(\"span\", {\n                    children: \"Search users\"\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 315,\n                    columnNumber: 176\n                  }, _this)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 315,\n                  columnNumber: 169\n                }, _this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 315,\n                columnNumber: 68\n              }, _this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 315,\n              columnNumber: 29\n            }, _this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 314,\n            columnNumber: 29\n          }, _this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 307,\n          columnNumber: 25\n        }, _this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 304,\n        columnNumber: 21\n      }, _this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 303,\n      columnNumber: 18\n    }, _this);\n  }\n};\n\n_s(chat, \"feQBzUWM5zSTVQear+edItGMfrI=\");\n\nexport var __N_SSP = true;\nexport default chat;\n\nvar SentSvg = function SentSvg() {\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 64 64\",\n    children: /*#__PURE__*/_jsxDEV(\"g\", {\n      id: \"Layer_95\",\n      \"data-name\": \"Layer 95\",\n      children: [/*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M53.06,10.94a1.5,1.5,0,0,0-1.53-.36l-40,13.33a1.51,1.51,0,0,0-.06,2.83l18.7,7.09,7.09,18.7a1.51,1.51,0,0,0,1.44,1,1.49,1.49,0,0,0,1.39-1l13.33-40A1.5,1.5,0,0,0,53.06,10.94Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 107\n      }, _this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M20.22,35.48a1.5,1.5,0,0,0-2.12-2.12l-4.48,4.48a1.51,1.51,0,0,0,0,2.12,1.49,1.49,0,0,0,2.12,0Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 291\n      }, _this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M23.88,40.12a1.49,1.49,0,0,0-2.12,0L16.08,45.8a1.5,1.5,0,0,0,2.12,2.12l5.68-5.68A1.49,1.49,0,0,0,23.88,40.12Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 397\n      }, _this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M28.52,43.78,24,48.26a1.5,1.5,0,0,0,2.12,2.12l4.48-4.48A1.5,1.5,0,0,0,28.52,43.78Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 329,\n        columnNumber: 518\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 329,\n      columnNumber: 69\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 329,\n    columnNumber: 9\n  }, _this);\n};\n\n_c = SentSvg;\n\nvar Users = function Users(props) {\n  _s2();\n\n  var _React$useState21 = React.useState(props.userData.notSeenMessageNumber),\n      _React$useState22 = _slicedToArray(_React$useState21, 2),\n      notSeenMessageNumberlocal = _React$useState22[0],\n      setNotSeenMessageNumberlocal = _React$useState22[1];\n\n  React.useEffect(function () {\n    setNotSeenMessageNumberlocal(props.userData.notSeenMessageNumber);\n  }, [props.userData.notSeenMessageNumber]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.userContainer,\n      onClick: function onClick() {\n        props.getUserdata(props.userData), setNotSeenMessageNumberlocal(0), props.setColorOfChat(props.userData.color);\n      },\n      children: [notSeenMessageNumberlocal != 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.notSeenMessageNumbe,\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: notSeenMessageNumberlocal\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 341,\n          columnNumber: 95\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 341,\n        columnNumber: 52\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.imgContainer,\n        children: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: props.userData.currentImageUrl || \"/avatar.png\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 342,\n          columnNumber: 58\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 342,\n        columnNumber: 21\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.userName,\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: props.userData.userName\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 343,\n          columnNumber: 54\n        }, _this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 343,\n        columnNumber: 21\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 340,\n      columnNumber: 17\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 339,\n    columnNumber: 13\n  }, _this);\n};\n\n_s2(Users, \"pd1fD7onXKAt+z6/CWeN/oALkEw=\");\n\n_c2 = Users;\n\nvar ColorPicker = function ColorPicker(props) {\n  _s3();\n\n  var _React$useState23 = React.useState(false),\n      _React$useState24 = _slicedToArray(_React$useState23, 2),\n      openColorPicker = _React$useState24[0],\n      setOpenColorPicker = _React$useState24[1];\n\n  var changePrimaryColor = function changePrimaryColor(color) {\n    props.getNewColorfn(color);\n    updateColorChat({\n      newColor: color,\n      receiver: props.receiver\n    }, props.token);\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    onClick: function onClick() {\n      return setOpenColorPicker(function (e) {\n        return !e;\n      });\n    },\n    className: Style.chatColor,\n    style: {\n      backgroundColor: props.chatColor.colorone\n    },\n    children: openColorPicker && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.colorPicker,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#ff1744\");\n        },\n        style: {\n          backgroundColor: \"#ff1744\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 358,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#f50057\");\n        },\n        style: {\n          backgroundColor: \"#f50057\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 359,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#3d5afe\");\n        },\n        style: {\n          backgroundColor: \"#3d5afe\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 360,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#76ff03\");\n        },\n        style: {\n          backgroundColor: \"#76ff03\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 361,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#c6ff00\");\n        },\n        style: {\n          backgroundColor: \"#c6ff00\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 362,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#ff3d00\");\n        },\n        style: {\n          backgroundColor: \"#ff3d00\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 363,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#651fff\");\n        },\n        style: {\n          backgroundColor: \"#651fff\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 364,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#ffea00\");\n        },\n        style: {\n          backgroundColor: \"#ffea00\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 365,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#f50057\");\n        },\n        style: {\n          backgroundColor: \"#f50057\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 366,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#ff1744\");\n        },\n        style: {\n          backgroundColor: \"#ff1744\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 367,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#1de9b6\");\n        },\n        style: {\n          backgroundColor: \"#1de9b6\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 368,\n        columnNumber: 17\n      }, _this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.color,\n        onClick: function onClick() {\n          return changePrimaryColor(\"#03a9f4\");\n        },\n        style: {\n          backgroundColor: \"#03a9f4\"\n        }\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 369,\n        columnNumber: 17\n      }, _this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 357,\n      columnNumber: 27\n    }, _this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 356,\n    columnNumber: 12\n  }, _this);\n};\n\n_s3(ColorPicker, \"pZgH7UcsKyXt6VoMsQjt7zbvjT4=\");\n\n_c3 = ColorPicker;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"SentSvg\");\n$RefreshReg$(_c2, \"Users\");\n$RefreshReg$(_c3, \"ColorPicker\");","map":{"version":3,"sources":["F:/AHKI/pages/chat.js"],"names":["React","Style","NavBar","Picker","Emoji","searchUserNameApi","updateColorChat","addMessage","getMessagesOfCurrentconversation","getUserWhoChatWith","socketContext","userContext","chat","props","useState","closeOrOpenEmojiPickerState","setcloseOrOpenEmojiPickerState","EmojiContainerHeight","setEmojiContainerHeight","listOfUsers","setListOfUsers","currentImageUrl","undefined","userName","_id","currentUserToChatWith","setCurrentUserToChatWith","message","setMessage","currentChats","setCurrentChats","messagesComp","useRef","useContext","user","setUser","socket","setSocket","skip","setSkip","isWritingState","setIsWritingState","colorone","colortwo","chatColor","setChatColor","width","height","heightAndWidthOfWindow","setHeightAndWidthOfWindow","useEffect","window","innerHeight","innerWidth","secondUser","token","then","data","e","reverse","error","console","log","length","result","newUserWhoChatWith","map","firstUser","Promise","resolve","secoundUser","color","notSeenMessageNumber","all","newarray","current","scrollTop","scrollHeight","clientHeight","emit","state","otherUserId","chatHandler","audio","Audio","play","senderId","ListOfUser","r","Math","random","toString","substring","users","text","isWriting","userWhoReciveWriting","senderid","setvu","document","getElementsByClassName","yourMessageVu","i","childNodes","style","on","off","addEmoji","sym","unified","split","codesArray","forEach","el","push","emoji","String","fromCodePoint","closeOrOpenEmojiPicker","searchForUser","target","value","getUserdataFn","currentUserData","sendMessage","receiver","FirstTime","messageHandler","scrollfn","getNewColor","setColorOfChatFn","colorOfChatFromDataBase","container","chatAndRandomOnlineUserContaner","UserContaner","header","listContacs","bottom","searchContainer","inputcss","chatContainer","headerOfChatuserNameAndName","userImageContainer","isWritingContainer","ldsellipsis","changeColorContainer","messages","oneMessage","messageText","date","slice","backgroundColor","seen","preventDefault","inputContainer","btns","openOrCloseEmojiPicker","emojiLogo","id","skin","emojiPickerContainer","btnsend","sendMessageBtn","UserContanerMobile","SentSvg","Users","userData","notSeenMessageNumberlocal","setNotSeenMessageNumberlocal","userContainer","getUserdata","setColorOfChat","notSeenMessageNumbe","imgContainer","ColorPicker","openColorPicker","setOpenColorPicker","changePrimaryColor","getNewColorfn","newColor","colorPicker"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport Style from '../styles/chat.module.scss'\r\nimport NavBar from '../components/navBar/NavBar'\r\nimport { Picker,Emoji  } from 'emoji-mart'\r\nimport 'emoji-mart/css/emoji-mart.css'\r\nimport {searchUserNameApi} from '../services/user'\r\nimport {updateColorChat,addMessage,getMessagesOfCurrentconversation,getUserWhoChatWith} from '../services/chat';\r\nimport socketContext from '../context/socketContext'\r\nimport userContext from '../context/userContext'\r\n\r\nconst chat = (props) => {\r\n\r\n    const [closeOrOpenEmojiPickerState,setcloseOrOpenEmojiPickerState]=React.useState(false)\r\n    const [EmojiContainerHeight, setEmojiContainerHeight] = React.useState(9)//responsive handler\r\n    const [listOfUsers,setListOfUsers]=React.useState([])\r\n    const [currentUserToChatWith,setCurrentUserToChatWith]=React.useState({currentImageUrl:undefined,userName:undefined,_id:undefined})\r\n    const [message,setMessage]=React.useState(\"\")\r\n    const [currentChats,setCurrentChats]=React.useState([])\r\n    const messagesComp=React.useRef(null)\r\n    const [user,setUser]=React.useContext(userContext)\r\n    const [socket,setSocket]=React.useContext(socketContext)\r\n    const [skip,setSkip]=React.useState(()=>0)\r\n    const [isWritingState,setIsWritingState]=React.useState(false)\r\n    const [chatColor,setChatColor]=React.useState({colorone:\"#1876f3\",colortwo:\"#e4e6eb\"})\r\n    const [heightAndWidthOfWindow, setHeightAndWidthOfWindow] = React.useState({ width: 0, height: 0 })//responsive handler\r\n\r\n    /**********************************/\r\n    /*************useEffects***********/\r\n    /**********************************/\r\n    React.useEffect(()=>{\r\n\r\n        setHeightAndWidthOfWindow({ height: window.innerHeight, width: window.innerWidth }) \r\n    },[])\r\n    //when you scrol top on convertation it will load new 20 message\r\n    React.useEffect(()=>{\r\n        if(currentUserToChatWith._id!=undefined){\r\n            getMessagesOfCurrentconversation({secondUser:currentUserToChatWith._id,skip:skip},props.token).then(data=>{\r\n                setCurrentChats(e=>[...data.data.data.reverse(),...e])\r\n               \r\n            }).catch(error=>{\r\n                console.log(error)\r\n            })\r\n        }\r\n      },[skip])\r\n\r\n      // get list of users  you chat with\r\n    React.useEffect(()=>{\r\n        if(user._id!=undefined&& user._id.length>2)\r\n        getUserWhoChatWith({},props.token).then(result=>{\r\n            let newUserWhoChatWith=result.data.data.map(e=>{\r\n                //this to return the data of the other user not your data because im return both of data sender and reciver \r\n                if(e.firstUser._id==user._id){\r\n                    return Promise.resolve({...e.secoundUser,color:e.color,notSeenMessageNumber:e.notSeenMessageNumber})\r\n                }else{\r\n                    return Promise.resolve({...e.firstUser,color:e.color,notSeenMessageNumber:e.notSeenMessageNumber})\r\n                }\r\n           \r\n               \r\n            })\r\n            Promise.all(newUserWhoChatWith).then(newarray=>{\r\n              setListOfUsers([...newarray])\r\n            })\r\n         \r\n          }).catch(e=>console.log(e.message))\r\n    },[user])\r\n\r\n    //when you click on user it will load convertation data\r\n    React.useEffect(()=>{\r\n        if(currentUserToChatWith._id!=undefined){\r\n            getMessagesOfCurrentconversation({secondUser:currentUserToChatWith._id,skip:0},props.token).then(data=>{\r\n                \r\n                setCurrentChats([...data.data.data.reverse()])\r\n                messagesComp.current.scrollTop=messagesComp.current.scrollHeight+ messagesComp.current.clientHeight;\r\n\r\n\r\n            }).catch(error=>{\r\n                console.log(error)\r\n            })\r\n\r\n            //when you open convertation its will make all messgage seen\r\n            socket.emit(\"vu\",{state:true,otherUserId:currentUserToChatWith._id})\r\n\r\n        }\r\n    },[currentUserToChatWith])\r\n\r\n    //socket receving data handler\r\n    React.useEffect(()=>{\r\n        //on reciving messsage socket\r\n        async  function  chatHandler(data){\r\n            let audio = new Audio(\"./msgSound.mp3\")\r\n            audio.play()\r\n            setIsWritingState(false)\r\n            //set vu if you are in converation \r\n            socket.emit(\"vu\",{state:true,otherUserId:currentUserToChatWith._id})\r\n            //if you are not in convertion add +1 to message not read in user image\r\n            let ListOfUser = await listOfUsers.map((e)=>{\r\n                if(data.senderId==e._id && currentUserToChatWith._id!=e._id){\r\n                    e.notSeenMessageNumber=e.notSeenMessageNumber+1\r\n                    return Promise.resolve(e)\r\n                }else{\r\n                    return Promise.resolve(e)\r\n                }\r\n            })\r\n            Promise.all(ListOfUser).then(data=>{\r\n                \r\n                setListOfUsers(data)\r\n            })\r\n            //add message to chat\r\n            if(data.senderId==currentUserToChatWith._id){\r\n                \r\n                setCurrentChats(e=>{\r\n                    let r = Math.random().toString(36).substring(7);\r\n                    return [...e,{users:[data.senderId],message:data.text,_id:r}]\r\n                })\r\n                messagesComp.current.scrollTop=messagesComp.current.scrollHeight+ messagesComp.current.clientHeight;\r\n\r\n            }else{\r\n\r\n            }\r\n        }\r\n        //if the other user is wrting add animation if wrting\r\n        function isWriting(data){\r\n            if(data.userWhoReciveWriting==user._id && data.senderid==currentUserToChatWith._id){\r\n                setIsWritingState(data.isWriting)\r\n\r\n            }\r\n        }\r\n        // if other user has seen you message seen icon will be blue\r\n        const setvu=(data)=>{\r\n            if(document.getElementsByClassName(Style.yourMessageVu).length!=0){\r\n                for (let i = currentChats.length-1; i>0; i--) {\r\n                    if(document.getElementsByClassName(Style.yourMessageVu)[i]!=undefined){\r\n                        if(document.getElementsByClassName(Style.yourMessageVu)[i].childNodes[1].style.color!=\"rgb(24, 118, 243)\"){\r\n                            document.getElementsByClassName(Style.yourMessageVu)[i].childNodes[1].style.color=\"rgb(24, 118, 243)\"\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n        }\r\n        if(socket!=undefined && socket!=null){\r\n        socket.on(\"isWritingState\",isWriting)\r\n        socket.on(\"getMessageFromUserToUser\",chatHandler)\r\n        socket.on(\"setvu\",setvu)\r\n          }\r\n          return () => {\r\n            if(socket!=undefined && socket!=null){\r\n                socket.off('getMessageFromUserToUser', chatHandler);\r\n                socket.off(\"isWritingState\",isWriting)\r\n                socket.off(\"setvu\",setvu)\r\n\r\n            }\r\n          }\r\n      })\r\n\r\n      //add emoji to input\r\n    const addEmoji=(e)=>{\r\n        let sym = e.unified.split('-')\r\n        let codesArray = []\r\n        sym.forEach(el => codesArray.push('0x' + el))\r\n        let emoji = String.fromCodePoint(...codesArray)\r\n        setMessage(el=>{return el+emoji})\r\n      };\r\n\r\n      //close or open emoji container\r\n    const closeOrOpenEmojiPicker=()=>{\r\n        setcloseOrOpenEmojiPickerState(e=>!e)\r\n      }\r\n\r\n      //search for user to send message\r\n      const searchForUser=(e)=>{\r\n            searchUserNameApi(e.target.value,props.token).then((result=>{\r\n                if(result.data.data!=undefined){\r\n                    setListOfUsers(e=>{\r\n                        return [...result.data.data]\r\n                    }) \r\n                }\r\n            }))\r\n        \r\n      }\r\n\r\n      //on click on user get current user data\r\n      const getUserdataFn=(currentUserData)=>{\r\n        setCurrentUserToChatWith(currentUserData)\r\n      }\r\n\r\n\r\n      const sendMessage=()=>{\r\n        if(message.length>0&&currentUserToChatWith._id!=undefined){\r\n        addMessage({receiver:currentUserToChatWith._id,message:message,FirstTime:currentChats.length},props.token).then(data=>{\r\n            setCurrentChats(e=>{\r\n                let r = Math.random().toString(36).substring(7);\r\n                return [...e,{users:[user._id],message:message,_id:r}]\r\n\r\n            })\r\n            \r\n            messagesComp.current.scrollTop=messagesComp.current.scrollHeight+ messagesComp.current.clientHeight;\r\n            socket.emit(\"sendMessageFromUserToUser\",{otherUserId:currentUserToChatWith._id,text:message,senderId:user._id})\r\n\r\n          \r\n\r\n            setMessage(\"\")\r\n        }).catch(error=>{\r\n            console.log(error)\r\n        })\r\n    }\r\n      }\r\n      const messageHandler=(e)=>{\r\n          if(currentUserToChatWith._id!=undefined){\r\n            if(e.target.value.length>0){\r\n                socket.emit(\"isWriting\",{isWriting:true,otherUserId:currentUserToChatWith._id,senderid:user._id})\r\n              }else{\r\n                socket.emit(\"isWriting\",{isWriting:false,otherUserId:currentUserToChatWith._id,senderid:user._id})\r\n              }\r\n          }\r\n \r\n        setMessage(e.target.value)\r\n      }\r\n      //on scrol to top load 20 new message\r\n      const scrollfn=(e)=>{\r\n          //if( e.target.scrollTop === (e.target.scrollHeight - e.target.offsetHeight)){\r\n          if( e.target.scrollTop === 0){\r\n            setSkip(e=>e+20)\r\n          }\r\n          \r\n      }\r\n      //if you change the color of converation\r\n      const getNewColor=(color)=>{\r\n        setChatColor(e=>{return {...e,colorone:color}})\r\n      }\r\n\r\n      //set color if convertation\r\n      const setColorOfChatFn=(colorOfChatFromDataBase)=>{\r\n        if(colorOfChatFromDataBase==undefined){\r\n            setChatColor(e=>{\r\n                return{...e,colorone:\"#1876f3\"}\r\n            })\r\n        }else{\r\n            setChatColor(e=>{\r\n                return{...e,colorone:colorOfChatFromDataBase}\r\n            })\r\n        }\r\n      }\r\n      if (heightAndWidthOfWindow.width > heightAndWidthOfWindow.height) {\r\n        return (\r\n            <div className={Style.container} >\r\n                      <NavBar token={props.token}></NavBar>\r\n                    <div className={Style.chatAndRandomOnlineUserContaner}>\r\n                        \r\n                        <div className={Style.UserContaner} >\r\n                            <div className={Style.header}>\r\n                                <h1>contacts</h1>\r\n                            </div>\r\n                            <div className={Style.listContacs}>\r\n                            {listOfUsers.map(e=><Users setColorOfChat={setColorOfChatFn} getUserdata={getUserdataFn} key={e._id}  userData={e}></Users>)}\r\n    \r\n                            </div>\r\n                            <div className={Style.bottom}>\r\n                            <div className={Style.searchContainer}><div className={Style.inputcss}><input onChange={(e)=>searchForUser(e)} type=\"text\" required></input><label><span>Search users</span></label></div></div>\r\n                            </div>\r\n                        </div>\r\n                        <div className={Style.chat}>\r\n                        <div className={Style.header}>\r\n                            <h1>Messages</h1>\r\n                        </div>\r\n                        <div className={Style.chatContainer}>\r\n                            <div className={Style.headerOfChatuserNameAndName}>\r\n                                <div className={Style.userImageContainer}><img src={currentUserToChatWith.currentImageUrl || \"/avatar.png\"} /></div>\r\n                                <div className={Style.userName}><h3>{currentUserToChatWith.userName}</h3></div>\r\n                                {isWritingState&&<div className={Style.isWritingContainer}>\r\n                                <div className={Style.ldsellipsis}><div></div><div></div><div></div><div></div></div>\r\n                                    </div>}\r\n                                <div className={Style.changeColorContainer}><ColorPicker receiver={currentUserToChatWith._id} token={props.token} getNewColorfn={getNewColor} chatColor={chatColor}></ColorPicker></div>\r\n                            </div>\r\n                            <div onScroll={(e)=>scrollfn(e)} ref={messagesComp} className={Style.messages}>\r\n                                {currentChats.map(e=>{\r\n                                    return(<div key={e._id} className={Style.oneMessage}>\r\n                                        {e.users[0]==currentUserToChatWith._id?\r\n                                        <div className={Style.messageText} text-data={e.date!=undefined?e.date.slice(0,10)+\" \"+e.date.slice(11,16):\"false\"}  style={{\"--i\":\"0%\",float:\"left\",backgroundColor:\"#e4e6eb\",color:\"black\"}}><p>{e.message}</p></div>:\r\n                                        <div className={`${Style.messageText} ${Style.yourMessageVu} `}   text-data={e.date!=undefined?e.date.slice(0,10)+\" \"+e.date.slice(11,16):\"false\"}  style={{\"--i\":\"-100%\",float:\"right\",backgroundColor:chatColor.colorone,color:\"white\"}}><p>{e.message}</p><span  style={e.seen==true?{color:\"#1876f3\"}:{color:\"black\"}} className={Style.seen} >&#10004;</span></div>\r\n                                        }\r\n                                    </div>)\r\n                                })}\r\n                            </div>\r\n                        </div>\r\n                        <div className={Style.sendMessage}>\r\n                            <form onSubmit={e=>e.preventDefault()} >\r\n                            <div className={Style.inputContainer}><div className={Style.inputcss}><input  value={message} onChange={(e)=>messageHandler(e)} type=\"text\" required></input><label><span>Message</span></label></div></div>\r\n                            <div className={Style.btns}>\r\n                            <div className={Style.openOrCloseEmojiPicker} onClick={()=>closeOrOpenEmojiPicker()}>\r\n                            <div className={Style.emojiLogo}><Emoji emoji={{ id: 'smiling_face_with_3_hearts', skin: 3 }} size={16} /></div>\r\n                            {closeOrOpenEmojiPickerState&&<div className={Style.emojiPickerContainer}><Picker perLine={EmojiContainerHeight} onSelect={(e)=>addEmoji(e)} /></div>}\r\n                            </div>\r\n                                <button type=\"submit\" className={Style.btnsend} onClick={()=>sendMessage()}><span className={Style.sendMessageBtn} ><SentSvg></SentSvg></span></button>\r\n                                </div>\r\n                            </form>\r\n                        </div>\r\n                        </div>\r\n                    </div>\r\n            </div>\r\n        )\r\n      }else{\r\n          return(<div>\r\n                    <div className={Style.container} >\r\n                    <NavBar token={props.token}></NavBar>\r\n\r\n                        <div className={Style.UserContanerMobile} >\r\n                            <div className={Style.header}>\r\n                                <h1>contacts</h1>\r\n                            </div>\r\n                            <div className={Style.listContacs}>\r\n                            {listOfUsers.map(e=><Users setColorOfChat={setColorOfChatFn} getUserdata={getUserdataFn} key={e._id}  userData={e}></Users>)}\r\n                            </div>\r\n                            <div className={Style.bottom}>\r\n                            <div className={Style.searchContainer}><div className={Style.inputcss}><input onChange={(e)=>searchForUser(e)} type=\"text\" required></input><label><span>Search users</span></label></div></div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>)\r\n      }\r\n\r\n}\r\n\r\nexport default chat\r\n\r\n\r\n  const SentSvg=()=>{\r\n    return (\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><g id=\"Layer_95\" data-name=\"Layer 95\"><path d=\"M53.06,10.94a1.5,1.5,0,0,0-1.53-.36l-40,13.33a1.51,1.51,0,0,0-.06,2.83l18.7,7.09,7.09,18.7a1.51,1.51,0,0,0,1.44,1,1.49,1.49,0,0,0,1.39-1l13.33-40A1.5,1.5,0,0,0,53.06,10.94Z\"/><path d=\"M20.22,35.48a1.5,1.5,0,0,0-2.12-2.12l-4.48,4.48a1.51,1.51,0,0,0,0,2.12,1.49,1.49,0,0,0,2.12,0Z\"/><path d=\"M23.88,40.12a1.49,1.49,0,0,0-2.12,0L16.08,45.8a1.5,1.5,0,0,0,2.12,2.12l5.68-5.68A1.49,1.49,0,0,0,23.88,40.12Z\"/><path d=\"M28.52,43.78,24,48.26a1.5,1.5,0,0,0,2.12,2.12l4.48-4.48A1.5,1.5,0,0,0,28.52,43.78Z\"/></g></svg>\r\n        )\r\n  }\r\n  const Users=(props)=>{\r\n    \r\n      const [notSeenMessageNumberlocal,setNotSeenMessageNumberlocal]=React.useState(props.userData.notSeenMessageNumber)\r\n      React.useEffect(()=>{\r\n        setNotSeenMessageNumberlocal(props.userData.notSeenMessageNumber)\r\n      },[props.userData.notSeenMessageNumber])\r\n    return(\r\n            <div>\r\n                <div className={Style.userContainer} onClick={()=>{props.getUserdata(props.userData),setNotSeenMessageNumberlocal(0),props.setColorOfChat(props.userData.color)}}>\r\n                    {notSeenMessageNumberlocal!=0&&<div className={Style.notSeenMessageNumbe}><span>{notSeenMessageNumberlocal}</span></div>}\r\n                    <div  className={Style.imgContainer}><img src={props.userData.currentImageUrl || \"/avatar.png\"} /></div>\r\n                    <div  className={Style.userName}><p>{props.userData.userName}</p></div>\r\n                </div>\r\n            </div>\r\n    )\r\n}\r\n\r\n\r\nconst ColorPicker=(props)=>{\r\n    const [openColorPicker,setOpenColorPicker]=React.useState(false)\r\n    const changePrimaryColor=(color)=>{\r\n        props.getNewColorfn(color)\r\n        updateColorChat({newColor:color,receiver:props.receiver},props.token)\r\n    }\r\n    return(<div onClick={()=>setOpenColorPicker(e=>!e)} className={Style.chatColor} style={{backgroundColor:props.chatColor.colorone}}>\r\n        {openColorPicker&&<div className={Style.colorPicker}>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#ff1744\")} style={{backgroundColor:\"#ff1744\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#f50057\")} style={{backgroundColor:\"#f50057\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#3d5afe\")} style={{backgroundColor:\"#3d5afe\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#76ff03\")} style={{backgroundColor:\"#76ff03\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#c6ff00\")} style={{backgroundColor:\"#c6ff00\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#ff3d00\")} style={{backgroundColor:\"#ff3d00\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#651fff\")} style={{backgroundColor:\"#651fff\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#ffea00\")} style={{backgroundColor:\"#ffea00\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#f50057\")} style={{backgroundColor:\"#f50057\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#ff1744\")} style={{backgroundColor:\"#ff1744\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#1de9b6\")} style={{backgroundColor:\"#1de9b6\"}}></div>\r\n                <div className={Style.color} onClick={()=>changePrimaryColor(\"#03a9f4\")} style={{backgroundColor:\"#03a9f4\"}}></div>\r\n                \r\n\r\n            </div>}\r\n        </div>\r\n    )\r\n}\r\nexport async function getServerSideProps({req,res}) {\r\n\r\n    return req.cookies.token ?{props: {token:req.cookies.token}}:{redirect: { destination: '/', permanent: false, }}\r\n}"]},"metadata":{},"sourceType":"module"}