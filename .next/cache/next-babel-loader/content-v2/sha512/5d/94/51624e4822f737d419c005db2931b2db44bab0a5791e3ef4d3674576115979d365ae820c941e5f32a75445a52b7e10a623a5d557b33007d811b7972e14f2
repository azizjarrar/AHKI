{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"F:\\\\AHKI\\\\components\\\\biggerImagewithcomments\\\\biggerImagewithcomments.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React from 'react';\nimport Style from './biggerImagewithcomments.module.scss';\nimport { getImageData } from '../../services/images';\nimport Heart from '../../components/heart/heart';\nimport userContext from '../../context/userContext';\nimport { Picker, Emoji } from 'emoji-mart';\nimport 'emoji-mart/css/emoji-mart.css';\nimport LanguageContext from '../../context/languageContext';\nimport { addCommentToImage, getCommentsImage, countComments } from '../../services/imageComments';\nimport { countImageLikes } from '../../services/imageLikes';\nimport { deleteImage } from '../../services/images';\nimport Comment from '../comment/comment';\nimport ShowLikesUserNames from '../showLikesUserNames/showLikesUserNames';\nimport PopUpMessage from '../../components/popUpMessage/popUpMessage';\n\nconst biggerImagewithcomments = props => {\n  const [currentimage, setCurrentimage] = React.useState({}); // has the data of the current image\n\n  const [nextimage, setNextimage] = React.useState(); // has id of next image\n\n  const [previmage, setPrevimage] = React.useState(); //has id fo prev image\n\n  const [comments, setComments] = React.useState(false); //open or close comments\n\n  const [imageLoading, setimageLoading] = React.useState(false);\n  const [likesNumber, setLikesNumber] = React.useState(0);\n  const [coummentNumber, setCoummentNumber] = React.useState(0);\n  const [setOwnerOfImageData, setSetOwnerOfImageData] = React.useState({\n    userData: {\n      currentImageUrl: \"\",\n      userName: \"\"\n    }\n  });\n  const [user, setUser] = React.useContext(userContext); //user data\n\n  const [textAreaData, setTextAreaData] = React.useState(\"\"); // text area for add comment\n\n  const [countLettres, setCountLettres] = React.useState(0); // count how many lettre in text area\n\n  const [closeOrOpenEmojiPickerState, setcloseOrOpenEmojiPickerState] = React.useState(false); //emoji handler\n\n  const [language, setLanguage] = React.useContext(LanguageContext);\n  const [skip, setSkip] = React.useState(0); //fetch data with skip\n\n  const [commentsData, setCommentsData] = React.useState([]); //comments Container\n\n  const [addsOneToCommentCount, setaddOneToCommentCount] = React.useState(0); //when add comment automaticly add + to old one\n\n  const [moreComments, setMoreComments] = React.useState(false); //show more comment fetch  with 3 by 3\n\n  const [likesModal, setLikesModal] = React.useState(false); // show modal has all the name of who put like\n\n  const [settings, setSettings] = React.useState({\n    state: false,\n    firstClick: false\n  }); //show settings on click on 3 dots ...\n\n  /*************************************************************/\n\n  /*********************use effects*****************************/\n\n  /*************************************************************/\n\n  React.useState(() => {\n    /*he i fetch cureent img data and the next and prev image id */\n    setimageLoading(true);\n    getImageData({\n      currentImgId: props.imgid,\n      userid: props.userid\n    }, props.token).then(result => {\n      setimageLoading(false);\n      setSetOwnerOfImageData(result.data);\n      setCurrentimage(e => {\n        return _objectSpread({}, result.data.currentimage);\n      });\n      setNextimage(e => {\n        return _objectSpread({}, result.data.nextimage);\n      });\n      setPrevimage(e => {\n        return _objectSpread({}, result.data.previmage);\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  }, []);\n  /*calc textArea length */\n\n  React.useEffect(() => {\n    setCountLettres(textAreaData.length);\n  }, [textAreaData]); //when i change image fetch ne data of the current image\n\n  React.useEffect(() => {\n    setCommentsData([]);\n    setSkip(0);\n    setComments(false);\n    countImageLikes({\n      imageid: currentimage._id || props.imgid\n    }, props.token).then(result => {\n      setLikesNumber(result.data.count);\n    }).catch(error => {\n      console.log(error);\n    });\n\n    if (currentimage._id != undefined) {\n      getCommentsImage({\n        imageid: currentimage._id || props.imgid,\n        skip: 0\n      }, user.token).then(result => {\n        setComments(true);\n\n        if (result.data.data.length > 0) {\n          setMoreComments(true);\n        } else {\n          setMoreComments(false);\n        }\n\n        setCommentsData(e => [...e, ...result.data.data]);\n      }).catch(error => {\n        alert(error);\n      });\n      countComments({\n        imageid: currentimage._id || props.imgid,\n        skip: 0\n      }, user.token).then(result => {\n        setCoummentNumber(result.data.count);\n      }).catch(error => {\n        alert(error);\n      });\n    }\n  }, [currentimage._id]); //hedhi kenet t3awed tfetchi\n  //when i click load more comments get 3 new comment evry time\n\n  React.useEffect(() => {\n    if (skip != 0) {\n      getCommentsImage({\n        imageid: currentimage._id || props.imgid,\n        skip: skip\n      }, user.token).then(result => {\n        if (result.data.data.length > 0) {\n          setMoreComments(true);\n        } else {\n          setMoreComments(false);\n        }\n\n        setCommentsData(e => [...e, ...result.data.data]);\n      }).catch(error => {\n        alert(error);\n      });\n    }\n  }, [skip]);\n\n  const LoadMoreComments = () => {\n    setSkip(e => e + 3);\n  };\n  /* go to prev image */\n\n\n  const goPrev = () => {\n    setimageLoading(true);\n    getImageData({\n      currentImgId: previmage._id,\n      userid: props.userid\n    }, props.token).then(result => {\n      setimageLoading(false);\n      setCurrentimage(e => {\n        return _objectSpread(_objectSpread({}, e), result.data.currentimage);\n      });\n      setNextimage(e => {\n        return _objectSpread({}, result.data.nextimage);\n      });\n      setPrevimage(e => {\n        return _objectSpread({}, result.data.previmage);\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  }; // go to next image\n\n\n  const gonext = () => {\n    setimageLoading(true);\n    getImageData({\n      currentImgId: nextimage._id,\n      userid: props.userid\n    }, props.token).then(result => {\n      setimageLoading(false);\n      setCurrentimage(e => {\n        return _objectSpread(_objectSpread({}, e), result.data.currentimage);\n      });\n      setNextimage(e => {\n        return _objectSpread({}, result.data.nextimage);\n      });\n      setPrevimage(e => {\n        return _objectSpread({}, result.data.previmage);\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  };\n  /* set the height of text area and when text get bigger textarea get biiger with it */\n\n\n  const textAreaHolder = e => {\n    e.target.style.height = \"16px\";\n    e.target.style.height = e.target.scrollHeight + \"px\"; //only take 200 char\n\n    setTextAreaData(el => {\n      if (el.length <= 200) {\n        return e.target.value;\n      } else {\n        return el.slice(0, 200);\n      }\n    });\n  };\n  /* close emoji comp */\n\n\n  const closeOrOpenEmojiPicker = () => {\n    setcloseOrOpenEmojiPickerState(e => !e);\n  }; //add commnent\n\n\n  const AddComment = () => {\n    addCommentToImage({\n      imageid: currentimage._id,\n      commentText: textAreaData\n    }, user.token).then(result => {\n      setCommentsData(e => [_objectSpread(_objectSpread({}, result.data.data), {}, {\n        commentOwner: {\n          userName: user.userName,\n          currentImageUrl: user.currentImageUrl,\n          _id: user._id\n        }\n      }), ...e]);\n      setComments(true);\n      setaddOneToCommentCount(e => e + 1);\n      setTextAreaData(\"\");\n    }).catch(error => {\n      console.log(error);\n    });\n  }; //add emojo to textarea\n\n\n  const addEmoji = e => {\n    let sym = e.unified.split('-');\n    let codesArray = [];\n    sym.forEach(el => codesArray.push('0x' + el));\n    let emoji = String.fromCodePoint(...codesArray);\n    setTextAreaData(el => {\n      if (el.length <= 200) {\n        return el + emoji;\n      } else {\n        return el.slice(0, 200);\n      }\n    });\n  }; // open or close comments\n\n\n  const openComments = () => {\n    setComments(e => !e);\n  }; //when you like image it will add in time to numbers of likes\n\n\n  const addLikeInTime = newLikesNumber => {\n    setLikesNumber(e => e + newLikesNumber);\n  }; // show usernames of people who liked image\n\n\n  const openshowLikesUserNames = () => {\n    setLikesModal(e => !e);\n  }; //show settings delete report \n\n\n  const ShowSettings = () => {\n    if (settings.firstClick != true) {\n      setSettings({\n        state: true,\n        firstClick: true\n      });\n    }\n  }; // close settings componnent\n\n\n  const closeComponenet = () => {\n    setSettings({\n      state: false,\n      firstClick: false\n    });\n  };\n\n  const deleteCommentInCurrentTimefn = commentIdDeleted => {\n    setCommentsData(arrayOfComment => {\n      return [...arrayOfComment.filter(e => {\n        return e._id != commentIdDeleted;\n      })];\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: Style.container,\n    children: [likesModal && /*#__PURE__*/_jsxDEV(ShowLikesUserNames, {\n      closepopUp: openshowLikesUserNames,\n      imgid: currentimage._id || props.imgid\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 26\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.closeBtn,\n      onClick: () => props.close()\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 230,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.imageContainer,\n      children: [imageLoading && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.loadingAnimation,\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.ldsring,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 103\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 114\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 125\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 232,\n            columnNumber: 136\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 232,\n          columnNumber: 72\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 32\n      }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n        src: currentimage.imageUrl || \"\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 233,\n        columnNumber: 17\n      }, this), previmage != undefined && previmage._id != undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${Style.SwitchImage} ${Style.left}`,\n        onClick: () => goPrev(),\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u2039\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 153\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 234,\n        columnNumber: 74\n      }, this), nextimage != undefined && nextimage._id != undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: `${Style.SwitchImage} ${Style.Right}`,\n        onClick: () => gonext(),\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u203A\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 235,\n          columnNumber: 154\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 235,\n        columnNumber: 74\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 231,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.commentsContainer,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.imageOwnerAndNameAndDateAndParams,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.imageContainerForUserCommentsSection,\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: setOwnerOfImageData.userData.currentImageUrl\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 240,\n            columnNumber: 81\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 240,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.UserNameAndDate,\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: setOwnerOfImageData.userData.userName\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 242,\n            columnNumber: 25\n          }, this), currentimage.date != undefined && /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [currentimage.date.slice(0, 10), \" \", currentimage.date.slice(11, 16)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 243,\n            columnNumber: 60\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 241,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.Params,\n          onClick: () => ShowSettings(\"firstClick\"),\n          children: [settings.state == true && /*#__PURE__*/_jsxDEV(SettingsImage, {\n            previmage: previmage,\n            closeComponenetfn: closeComponenet,\n            userImageid: currentimage._id || props.imgid,\n            currentUserId: user._id,\n            ownerid: setOwnerOfImageData.currentimage.ImageOwner._id,\n            token: user.token\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 245,\n            columnNumber: 119\n          }, this), \"\\u2026\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 17\n      }, this), currentimage.imageText != undefined && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.bio,\n        children: /*#__PURE__*/_jsxDEV(\"p\", {\n          children: currentimage.imageText\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 84\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 57\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.LikesAndCommentsContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.Comments,\n          onClick: () => {\n            openComments();\n          },\n          children: [/*#__PURE__*/_jsxDEV(\"svg\", {\n            width: \"69\",\n            height: \"69\",\n            viewBox: \"0 0 69 69\",\n            fill: \"none\",\n            xmlns: \"http://www.w3.org/2000/svg\",\n            children: /*#__PURE__*/_jsxDEV(\"path\", {\n              d: \"M49.8333 24.6429C49.8333 11.0277 38.6807 0 24.9167 0C11.1526 0 0 11.0277 0 24.6429C0 29.9257 1.68906 34.7926 4.55208 38.8125C2.94688 43.4638 0.299479 47.1603 0.263542 47.2065C0 47.5607 -0.071875 48.0844 0.0838542 48.5464C0.239583 49.0085 0.575 49.2857 0.958333 49.2857C5.34271 49.2857 8.97239 47.3913 11.5839 45.4353C15.4411 47.8533 20.0052 49.2857 24.9167 49.2857C38.6807 49.2857 49.8333 38.258 49.8333 24.6429ZM64.4479 58.5268C67.3109 54.5223 69 49.64 69 44.3571C69 34.0533 62.5911 25.2281 53.5109 21.5471C53.6188 22.5636 53.6667 23.5955 53.6667 24.6429C53.6667 40.9533 40.7651 54.2143 24.9167 54.2143C23.6229 54.2143 22.3651 54.0911 21.1193 53.9216C24.8927 62.7777 33.7573 69 44.0833 69C48.9948 69 53.5589 67.583 57.4161 65.1496C60.0276 67.1056 63.6573 69 68.0417 69C68.425 69 68.7724 68.7074 68.9161 68.2607C69.0719 67.8141 69 67.2904 68.7365 66.9208C68.7005 66.8745 66.0531 63.1935 64.4479 58.5268Z\",\n              fill: \"#212121\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 250,\n              columnNumber: 121\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 250,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: Style.CommentsNumber,\n            children: coummentNumber + addsOneToCommentCount\n          }, \"unha\", false, {\n            fileName: _jsxFileName,\n            lineNumber: 251,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 249,\n          columnNumber: 20\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.likes,\n          children: [/*#__PURE__*/_jsxDEV(Heart, {\n            addLikeInTime: e => addLikeInTime(e),\n            imgid: currentimage._id || props.imgid,\n            token: props.token\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 254,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: Style.likesNumber,\n            onClick: () => openshowLikesUserNames(),\n            children: likesNumber\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 255,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 253,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 248,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.userAddComments,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.userImageInComments,\n          children: /*#__PURE__*/_jsxDEV(\"img\", {\n            src: user.currentImageUrl || \"/avatar.png\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 260,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 259,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.textAreaContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n            placeholder: \"say somthing\",\n            onChange: e => textAreaHolder(e),\n            value: textAreaData,\n            className: Style.textArea\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 263,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.countLettres,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: Style.countLettresCss,\n              style: countLettres >= 200 ? {\n                color: \"red\"\n              } : {},\n              children: [countLettres, \" : 200\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 264,\n              columnNumber: 61\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 264,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 262,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.emojiAndMaskAndPost,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.openOrCloseEmojiPicker,\n            onClick: () => closeOrOpenEmojiPicker(),\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: Style.emojiLogo,\n              children: /*#__PURE__*/_jsxDEV(Emoji, {\n                emoji: {\n                  id: 'smiling_face_with_3_hearts',\n                  skin: 3\n                },\n                size: 24\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 62\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 269,\n              columnNumber: 29\n            }, this), closeOrOpenEmojiPickerState && /*#__PURE__*/_jsxDEV(\"div\", {\n              className: Style.emojiPickerContainer,\n              children: /*#__PURE__*/_jsxDEV(Picker, {\n                perLine: 8,\n                onSelect: e => addEmoji(e)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 270,\n                columnNumber: 105\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 270,\n              columnNumber: 61\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: Style.postAndCounterContainer,\n            children: /*#__PURE__*/_jsxDEV(\"span\", {\n              className: Style.postText,\n              onClick: () => {\n                AddComment();\n              },\n              children: /*#__PURE__*/_jsxDEV(SentSvg, {}, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 274,\n                columnNumber: 95\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 274,\n              columnNumber: 29\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 273,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 17\n      }, this), comments && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: Style.commentsData,\n        children: [commentsData.map(e => {\n          return /*#__PURE__*/_jsxDEV(Comment, {\n            currentUserId: user._id,\n            ownerid: e.commentOwner,\n            deleteCommentInCurrentTime: deleteCommentInCurrentTimefn,\n            imgid: currentimage._id || props.imgid,\n            token: user.token,\n            date: e.date,\n            commentid: e._id,\n            text: e.commentText,\n            name: e.commentOwner.userName,\n            userProfileImageUrl: e.commentOwner.currentImageUrl\n          }, e._id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 281,\n            columnNumber: 21\n          }, this);\n        }), moreComments && /*#__PURE__*/_jsxDEV(\"div\", {\n          className: Style.loadMoreComments,\n          onClick: () => LoadMoreComments(),\n          children: /*#__PURE__*/_jsxDEV(\"p\", {\n            children: \"View more comments\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 284,\n            columnNumber: 101\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 284,\n          columnNumber: 28\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 278,\n        columnNumber: 26\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 237,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 228,\n    columnNumber: 9\n  }, this);\n};\n\nexport default biggerImagewithcomments;\n\nconst SentSvg = () => {\n  return /*#__PURE__*/_jsxDEV(\"svg\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    viewBox: \"0 0 64 64\",\n    children: /*#__PURE__*/_jsxDEV(\"g\", {\n      id: \"Layer_95\",\n      \"data-name\": \"Layer 95\",\n      children: [/*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M53.06,10.94a1.5,1.5,0,0,0-1.53-.36l-40,13.33a1.51,1.51,0,0,0-.06,2.83l18.7,7.09,7.09,18.7a1.51,1.51,0,0,0,1.44,1,1.49,1.49,0,0,0,1.39-1l13.33-40A1.5,1.5,0,0,0,53.06,10.94Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 107\n      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M20.22,35.48a1.5,1.5,0,0,0-2.12-2.12l-4.48,4.48a1.51,1.51,0,0,0,0,2.12,1.49,1.49,0,0,0,2.12,0Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 291\n      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M23.88,40.12a1.49,1.49,0,0,0-2.12,0L16.08,45.8a1.5,1.5,0,0,0,2.12,2.12l5.68-5.68A1.49,1.49,0,0,0,23.88,40.12Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 397\n      }, this), /*#__PURE__*/_jsxDEV(\"path\", {\n        d: \"M28.52,43.78,24,48.26a1.5,1.5,0,0,0,2.12,2.12l4.48-4.48A1.5,1.5,0,0,0,28.52,43.78Z\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 296,\n        columnNumber: 518\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 69\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 296,\n    columnNumber: 9\n  }, this);\n}; // this is the comp of image settings\n\n\nconst SettingsImage = props => {\n  // error handler\n  const [errorMessage, setErrorMessage] = React.useState({\n    state: false,\n    text: \"\"\n  }); // when state true show  pop up \n\n  const deleteImageFn = () => {\n    deleteImage({\n      imageid: props.userImageid,\n      previmage: props.previmage\n    }, props.token).then(result => {\n      if (result.data.state == true) {\n        //if you have only one image you cant deleted\n        setErrorMessage(e => {\n          return _objectSpread(_objectSpread({}, e), {}, {\n            state: true,\n            text: \"you should at least have one image\"\n          });\n        });\n      } else {\n        location.reload();\n      } //location.reload();\n\n    }).catch(error => {\n      console.log(error);\n    });\n  };\n\n  const closePopUp = () => {\n    setErrorMessage({\n      state: false,\n      text: \"\"\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: Style.containerSettings,\n    children: [errorMessage.state == true && /*#__PURE__*/_jsxDEV(PopUpMessage, {\n      fnclose: () => closePopUp(),\n      openPopUp: errorMessage\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 325,\n      columnNumber: 44\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.paramsContainer,\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Report\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 326,\n        columnNumber: 56\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 326,\n      columnNumber: 17\n    }, this), props.ownerid == props.currentUserId && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.paramsContainer,\n      onClick: () => deleteImageFn(),\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Delete\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 327,\n        columnNumber: 123\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 327,\n      columnNumber: 54\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: Style.paramsContainer,\n      onClick: () => props.closeComponenetfn(),\n      children: /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: \"Close\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 328,\n        columnNumber: 96\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 328,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 324,\n    columnNumber: 13\n  }, this);\n};","map":{"version":3,"sources":["F:/AHKI/components/biggerImagewithcomments/biggerImagewithcomments.js"],"names":["React","Style","getImageData","Heart","userContext","Picker","Emoji","LanguageContext","addCommentToImage","getCommentsImage","countComments","countImageLikes","deleteImage","Comment","ShowLikesUserNames","PopUpMessage","biggerImagewithcomments","props","currentimage","setCurrentimage","useState","nextimage","setNextimage","previmage","setPrevimage","comments","setComments","imageLoading","setimageLoading","likesNumber","setLikesNumber","coummentNumber","setCoummentNumber","setOwnerOfImageData","setSetOwnerOfImageData","userData","currentImageUrl","userName","user","setUser","useContext","textAreaData","setTextAreaData","countLettres","setCountLettres","closeOrOpenEmojiPickerState","setcloseOrOpenEmojiPickerState","language","setLanguage","skip","setSkip","commentsData","setCommentsData","addsOneToCommentCount","setaddOneToCommentCount","moreComments","setMoreComments","likesModal","setLikesModal","settings","setSettings","state","firstClick","currentImgId","imgid","userid","token","then","result","data","e","catch","error","console","log","useEffect","length","imageid","_id","count","undefined","alert","LoadMoreComments","goPrev","gonext","textAreaHolder","target","style","height","scrollHeight","el","value","slice","closeOrOpenEmojiPicker","AddComment","commentText","commentOwner","addEmoji","sym","unified","split","codesArray","forEach","push","emoji","String","fromCodePoint","openComments","addLikeInTime","newLikesNumber","openshowLikesUserNames","ShowSettings","closeComponenet","deleteCommentInCurrentTimefn","commentIdDeleted","arrayOfComment","filter","container","closeBtn","close","imageContainer","loadingAnimation","ldsring","imageUrl","SwitchImage","left","Right","commentsContainer","imageOwnerAndNameAndDateAndParams","imageContainerForUserCommentsSection","UserNameAndDate","date","Params","ImageOwner","imageText","bio","LikesAndCommentsContainer","Comments","CommentsNumber","likes","userAddComments","userImageInComments","textAreaContainer","textArea","countLettresCss","color","emojiAndMaskAndPost","openOrCloseEmojiPicker","emojiLogo","id","skin","emojiPickerContainer","postAndCounterContainer","postText","map","loadMoreComments","SentSvg","SettingsImage","errorMessage","setErrorMessage","text","deleteImageFn","userImageid","location","reload","closePopUp","containerSettings","paramsContainer","ownerid","currentUserId","closeComponenetfn"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport Style from './biggerImagewithcomments.module.scss'\r\nimport { getImageData } from '../../services/images'\r\nimport Heart from '../../components/heart/heart'\r\nimport userContext from '../../context/userContext'\r\nimport { Picker,Emoji  } from 'emoji-mart'\r\nimport 'emoji-mart/css/emoji-mart.css'\r\nimport LanguageContext from '../../context/languageContext'\r\nimport {addCommentToImage,getCommentsImage,countComments} from '../../services/imageComments'\r\nimport {countImageLikes} from '../../services/imageLikes'\r\nimport {deleteImage} from '../../services/images'\r\n\r\nimport Comment from '../comment/comment'\r\nimport ShowLikesUserNames from '../showLikesUserNames/showLikesUserNames'\r\nimport PopUpMessage from '../../components/popUpMessage/popUpMessage'\r\n\r\nconst biggerImagewithcomments = (props) => {\r\n    const [currentimage, setCurrentimage] = React.useState({})// has the data of the current image\r\n    const [nextimage, setNextimage] = React.useState() // has id of next image\r\n    const [previmage, setPrevimage] = React.useState() //has id fo prev image\r\n    const [comments, setComments] = React.useState(false)//open or close comments\r\n    const [imageLoading,setimageLoading]=React.useState(false)\r\n    const [likesNumber,setLikesNumber]=React.useState(0)\r\n    const [coummentNumber,setCoummentNumber]=React.useState(0)\r\n    const [setOwnerOfImageData, setSetOwnerOfImageData] = React.useState({\r\n        userData:{\r\n            currentImageUrl:\"\",\r\n            userName:\"\"\r\n        }\r\n    })\r\n    const [user,setUser]=React.useContext(userContext)//user data\r\n    const [textAreaData,setTextAreaData]=React.useState(\"\") // text area for add comment\r\n    const [countLettres,setCountLettres]=React.useState(0) // count how many lettre in text area\r\n    const [closeOrOpenEmojiPickerState,setcloseOrOpenEmojiPickerState]=React.useState(false)//emoji handler\r\n    const [language , setLanguage]=React.useContext(LanguageContext)\r\n    const [skip,setSkip]=React.useState(0)//fetch data with skip\r\n    const [commentsData,setCommentsData]=React.useState([])//comments Container\r\n    const [addsOneToCommentCount,setaddOneToCommentCount]=React.useState(0)//when add comment automaticly add + to old one\r\n    const [moreComments,setMoreComments]=React.useState(false) //show more comment fetch  with 3 by 3\r\n    const [likesModal,setLikesModal]=React.useState(false)// show modal has all the name of who put like\r\n    const [settings, setSettings] = React.useState({state:false,firstClick:false}) //show settings on click on 3 dots ...\r\n   /*************************************************************/\r\n   /*********************use effects*****************************/\r\n   /*************************************************************/\r\n    React.useState(() => {\r\n        /*he i fetch cureent img data and the next and prev image id */\r\n        setimageLoading(true)\r\n\r\n        getImageData({ currentImgId: props.imgid, userid: props.userid }, props.token).then(result => {\r\n            setimageLoading(false)\r\n            setSetOwnerOfImageData(result.data)\r\n            setCurrentimage(e => {\r\n                return { ...result.data.currentimage }\r\n            })\r\n            setNextimage(e => {\r\n                return { ...result.data.nextimage}\r\n            })\r\n            setPrevimage(e => {\r\n                return { ...result.data.previmage }\r\n            })\r\n        }).catch(error => {\r\n            console.log(error)\r\n        })\r\n   \r\n    }, [])\r\n    /*calc textArea length */\r\n    React.useEffect(()=>{\r\n        setCountLettres(textAreaData.length)\r\n      },[textAreaData])\r\n      //when i change image fetch ne data of the current image\r\n    React.useEffect(()=>{\r\n        setCommentsData([])\r\n        setSkip(0)\r\n        setComments(false)\r\n        countImageLikes({ imageid: currentimage._id||props.imgid}, props.token).then(result=>{\r\n            setLikesNumber(result.data.count)\r\n        }).catch(error=>{\r\n            console.log(error)\r\n        })\r\n        if(currentimage._id!=undefined){\r\n          getCommentsImage({imageid:currentimage._id||props.imgid,skip:0},user.token).then(result=>{\r\n              setComments(true)\r\n              if(result.data.data.length>0){\r\n                  setMoreComments(true)\r\n              }else{\r\n                  setMoreComments(false)\r\n              }\r\n              setCommentsData(e=>[...e,...result.data.data])\r\n            }).catch(error=>{\r\n                alert(error)\r\n            })\r\n            countComments({imageid:currentimage._id||props.imgid,skip:0},user.token).then(result=>{\r\n                setCoummentNumber(result.data.count)\r\n            }).catch(error=>{\r\n                alert(error)\r\n\r\n            })\r\n        }\r\n\r\n    },[currentimage._id])//hedhi kenet t3awed tfetchi\r\n    //when i click load more comments get 3 new comment evry time\r\n    React.useEffect(()=>{\r\n      if(skip!=0){\r\n          getCommentsImage({imageid:currentimage._id||props.imgid,skip:skip},user.token).then(result=>{\r\n              if(result.data.data.length>0){\r\n                  setMoreComments(true)\r\n              }else{\r\n                  setMoreComments(false)\r\n              }\r\n              setCommentsData(e=>[...e,...result.data.data])\r\n            }).catch(error=>{\r\n                alert(error)\r\n            })\r\n      }\r\n  },[skip])\r\n      const LoadMoreComments=()=>{\r\n        setSkip(e=>e+3)\r\n      }\r\n      /* go to prev image */\r\n    const goPrev = () => {\r\n        setimageLoading(true)\r\n        getImageData({ currentImgId: previmage._id, userid: props.userid }, props.token).then(result => {\r\n            \r\n            setimageLoading(false)\r\n            setCurrentimage(e => {\r\n                return { ...e, ...result.data.currentimage }\r\n            })\r\n            setNextimage(e => {\r\n                return { ...result.data.nextimage }\r\n            })\r\n            setPrevimage(e => {\r\n                return { ...result.data.previmage }\r\n            })\r\n        }).catch(error => {\r\n            console.log(error)\r\n        })\r\n    }\r\n    // go to next image\r\n    const gonext = () => {\r\n        setimageLoading(true)\r\n        getImageData({ currentImgId: nextimage._id, userid: props.userid }, props.token).then(result => {\r\n            setimageLoading(false)\r\n            setCurrentimage(e => {\r\n                return { ...e, ...result.data.currentimage }\r\n            })\r\n            setNextimage(e => {\r\n                return { ...result.data.nextimage }\r\n            })\r\n            setPrevimage(e => {\r\n                return { ...result.data.previmage }\r\n            })\r\n        }).catch(error => {\r\n            console.log(error)\r\n        })\r\n    }\r\n    /* set the height of text area and when text get bigger textarea get biiger with it */\r\n    const textAreaHolder=(e)=>{\r\n        e.target.style.height = \"16px\";\r\n        e.target.style.height = (e.target.scrollHeight)+\"px\";\r\n        //only take 200 char\r\n        setTextAreaData(el=>{\r\n          if(el.length<=200){\r\n            return e.target.value\r\n          }else{\r\n           return el.slice(0,200)\r\n          }\r\n        })\r\n      }\r\n      /* close emoji comp */\r\n      const closeOrOpenEmojiPicker=()=>{\r\n        setcloseOrOpenEmojiPickerState(e=>!e)\r\n      }\r\n      //add commnent\r\n      const AddComment=()=>{\r\n        addCommentToImage({imageid:currentimage._id,commentText:textAreaData},user.token).then((result)=>{\r\n            setCommentsData(e=>[{...result.data.data,commentOwner:{userName:user.userName,currentImageUrl:user.currentImageUrl,_id:user._id}},...e])\r\n            setComments(true)\r\n            setaddOneToCommentCount(e=>e+1)\r\n            setTextAreaData(\"\")\r\n        }).catch(error=>{\r\n          console.log(error)\r\n        })\r\n      }\r\n      //add emojo to textarea\r\n      const addEmoji=(e)=>{\r\n        let sym = e.unified.split('-')\r\n        let codesArray = []\r\n        sym.forEach(el => codesArray.push('0x' + el))\r\n        let emoji = String.fromCodePoint(...codesArray)\r\n        setTextAreaData(el=>{\r\n          if(el.length<=200){\r\n            return el+emoji\r\n          }else{\r\n            return el.slice(0,200)\r\n          }\r\n        })\r\n      };\r\n      // open or close comments\r\n      const openComments = () => {\r\n        setComments(e => !e)\r\n      }\r\n      //when you like image it will add in time to numbers of likes\r\n      const addLikeInTime=(newLikesNumber)=>{\r\n        setLikesNumber(e=>e+newLikesNumber)\r\n      }\r\n      // show usernames of people who liked image\r\n      const openshowLikesUserNames=()=>{\r\n        setLikesModal(e=>!e)\r\n      }\r\n      //show settings delete report \r\n      const ShowSettings = () => {\r\n          if(settings.firstClick!=true){\r\n            setSettings({state:true,firstClick:true})\r\n          }\r\n      }\r\n      // close settings componnent\r\n      const closeComponenet=()=>{\r\n        setSettings({state:false,firstClick:false})\r\n      }\r\n      const deleteCommentInCurrentTimefn=(commentIdDeleted)=>{\r\n        setCommentsData(arrayOfComment=>{\r\n         return [...arrayOfComment.filter(e=>{\r\n           return e._id!=commentIdDeleted\r\n         })]\r\n        })\r\n      }\r\n    return (\r\n        <div className={Style.container}>\r\n            {likesModal&&<ShowLikesUserNames closepopUp={openshowLikesUserNames} imgid={currentimage._id||props.imgid}></ShowLikesUserNames>}\r\n            <div className={Style.closeBtn} onClick={() => props.close()}></div>\r\n            <div className={Style.imageContainer}>\r\n                {imageLoading&&<div className={Style.loadingAnimation}><div className={Style.ldsring}><div></div><div></div><div></div><div></div></div></div>}\r\n                <img src={currentimage.imageUrl || \"\"} />\r\n                {previmage != undefined && previmage._id != undefined && <div className={`${Style.SwitchImage} ${Style.left}`} onClick={() => goPrev()}><span>&#x2039;</span></div>}\r\n                {nextimage != undefined && nextimage._id != undefined && <div className={`${Style.SwitchImage} ${Style.Right}`} onClick={() => gonext()}><span>&#x203A;</span></div>}\r\n            </div>\r\n            <div className={Style.commentsContainer}>\r\n                <div className={Style.imageOwnerAndNameAndDateAndParams}>\r\n                    \r\n                    <div className={Style.imageContainerForUserCommentsSection}><img src={setOwnerOfImageData.userData.currentImageUrl} /></div>\r\n                    <div className={Style.UserNameAndDate}>\r\n                        <p>{setOwnerOfImageData.userData.userName}</p>\r\n                        {currentimage.date != undefined && <p>{currentimage.date.slice(0, 10)} {currentimage.date.slice(11, 16)}</p>}\r\n                    </div>\r\n                    <div className={Style.Params} onClick={() => ShowSettings(\"firstClick\")}>{settings.state==true && <SettingsImage previmage={previmage} closeComponenetfn={closeComponenet}   userImageid={currentimage._id||props.imgid} currentUserId={user._id} ownerid={setOwnerOfImageData.currentimage.ImageOwner._id} token={user.token} ></SettingsImage>}&hellip;</div>\r\n                </div>\r\n                {currentimage.imageText != undefined && <div className={Style.bio}><p>{currentimage.imageText}</p></div>}\r\n                <div className={Style.LikesAndCommentsContainer}>\r\n                   <div   className={Style.Comments} onClick={()=>{openComments()}}>\r\n                        <svg  width=\"69\" height=\"69\" viewBox=\"0 0 69 69\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M49.8333 24.6429C49.8333 11.0277 38.6807 0 24.9167 0C11.1526 0 0 11.0277 0 24.6429C0 29.9257 1.68906 34.7926 4.55208 38.8125C2.94688 43.4638 0.299479 47.1603 0.263542 47.2065C0 47.5607 -0.071875 48.0844 0.0838542 48.5464C0.239583 49.0085 0.575 49.2857 0.958333 49.2857C5.34271 49.2857 8.97239 47.3913 11.5839 45.4353C15.4411 47.8533 20.0052 49.2857 24.9167 49.2857C38.6807 49.2857 49.8333 38.258 49.8333 24.6429ZM64.4479 58.5268C67.3109 54.5223 69 49.64 69 44.3571C69 34.0533 62.5911 25.2281 53.5109 21.5471C53.6188 22.5636 53.6667 23.5955 53.6667 24.6429C53.6667 40.9533 40.7651 54.2143 24.9167 54.2143C23.6229 54.2143 22.3651 54.0911 21.1193 53.9216C24.8927 62.7777 33.7573 69 44.0833 69C48.9948 69 53.5589 67.583 57.4161 65.1496C60.0276 67.1056 63.6573 69 68.0417 69C68.425 69 68.7724 68.7074 68.9161 68.2607C69.0719 67.8141 69 67.2904 68.7365 66.9208C68.7005 66.8745 66.0531 63.1935 64.4479 58.5268Z\" fill=\"#212121\" /></svg>\r\n                        <p  key=\"unha\" className={Style.CommentsNumber} >{coummentNumber+addsOneToCommentCount}</p>\r\n                    </div>\r\n                    <div className={Style.likes}  >\r\n                        <Heart addLikeInTime={(e)=>addLikeInTime(e)}  imgid={currentimage._id||props.imgid} token={props.token} ></Heart>\r\n                        <p className={Style.likesNumber}  onClick={()=>openshowLikesUserNames()}>{likesNumber}</p>\r\n                    </div>\r\n                </div>\r\n                <div className={Style.userAddComments}>\r\n                    <div className={Style.userImageInComments}>\r\n                        <img src={user.currentImageUrl || \"/avatar.png\"} />\r\n                    </div>\r\n                    <div className={Style.textAreaContainer}>\r\n                        <textarea placeholder={\"say somthing\"} onChange={(e) => textAreaHolder(e)} value={textAreaData} className={Style.textArea} />\r\n                        <div className={Style.countLettres}><span className={Style.countLettresCss} style={countLettres >= 200 ? { color: \"red\" } : {}}>{countLettres} : 200</span></div>\r\n\r\n                    </div>\r\n                    <div className={Style.emojiAndMaskAndPost}>\r\n                        <div className={Style.openOrCloseEmojiPicker} onClick={() => closeOrOpenEmojiPicker()}>\r\n                            <div className={Style.emojiLogo}><Emoji emoji={{ id: 'smiling_face_with_3_hearts', skin: 3 }} size={24} /></div>\r\n                            {closeOrOpenEmojiPickerState && <div className={Style.emojiPickerContainer}><Picker perLine={8} onSelect={(e) => addEmoji(e)} /></div>}\r\n\r\n                        </div>\r\n                        <div className={Style.postAndCounterContainer}>\r\n                            <span className={Style.postText} onClick={() => { AddComment() }}><SentSvg></SentSvg></span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            {comments && <div className={Style.commentsData}>\r\n            {commentsData.map(e=>\r\n            {\r\n            return  <Comment currentUserId={user._id} ownerid={e.commentOwner} deleteCommentInCurrentTime={deleteCommentInCurrentTimefn} imgid={currentimage._id||props.imgid}  token={user.token} date={e.date} commentid={e._id} key={e._id} text={e.commentText} name={e.commentOwner.userName} userProfileImageUrl={e.commentOwner.currentImageUrl}></Comment>\r\n            }\r\n            )}\r\n            {moreComments&&<div className={Style.loadMoreComments} onClick={()=>LoadMoreComments()}><p>View more comments</p></div>}\r\n            </div>}\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default biggerImagewithcomments\r\n\r\nconst SentSvg=()=>{\r\n    return (\r\n        <svg xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 64 64\"><g id=\"Layer_95\" data-name=\"Layer 95\"><path d=\"M53.06,10.94a1.5,1.5,0,0,0-1.53-.36l-40,13.33a1.51,1.51,0,0,0-.06,2.83l18.7,7.09,7.09,18.7a1.51,1.51,0,0,0,1.44,1,1.49,1.49,0,0,0,1.39-1l13.33-40A1.5,1.5,0,0,0,53.06,10.94Z\"/><path d=\"M20.22,35.48a1.5,1.5,0,0,0-2.12-2.12l-4.48,4.48a1.51,1.51,0,0,0,0,2.12,1.49,1.49,0,0,0,2.12,0Z\"/><path d=\"M23.88,40.12a1.49,1.49,0,0,0-2.12,0L16.08,45.8a1.5,1.5,0,0,0,2.12,2.12l5.68-5.68A1.49,1.49,0,0,0,23.88,40.12Z\"/><path d=\"M28.52,43.78,24,48.26a1.5,1.5,0,0,0,2.12,2.12l4.48-4.48A1.5,1.5,0,0,0,28.52,43.78Z\"/></g></svg>\r\n        )\r\n}\r\n// this is the comp of image settings\r\nconst SettingsImage=(props)=>{\r\n    // error handler\r\n    const [errorMessage,setErrorMessage]=React.useState({state:false,text:\"\"})// when state true show  pop up \r\n   const deleteImageFn=()=>{\r\n        deleteImage({imageid:props.userImageid,previmage:props.previmage},props.token).then(result=>{\r\n            if(result.data.state==true){\r\n                //if you have only one image you cant deleted\r\n                setErrorMessage(e=>{\r\n                    return {...e,state:true,text:\"you should at least have one image\"}\r\n                })\r\n\r\n            }else{\r\n                location.reload();\r\n\r\n            }\r\n            //location.reload();\r\n        }).catch(error=>{\r\n            console.log(error)\r\n        })\r\n    }\r\n    const closePopUp=()=>{\r\n        setErrorMessage({state:false,text:\"\"})\r\n      }\r\n    return (\r\n            <div className={Style.containerSettings}>\r\n                {errorMessage.state==true&&<PopUpMessage fnclose={()=>closePopUp()} openPopUp={errorMessage}></PopUpMessage>}\r\n                <div className={Style.paramsContainer}><h3>Report</h3></div>\r\n                {props.ownerid==props.currentUserId&&<div className={Style.paramsContainer} onClick={()=>deleteImageFn()}><h3>Delete</h3></div>}\r\n                <div className={Style.paramsContainer} onClick={()=>props.closeComponenetfn()}><h3>Close</h3></div>\r\n            </div>\r\n            )\r\n}"]},"metadata":{},"sourceType":"module"}